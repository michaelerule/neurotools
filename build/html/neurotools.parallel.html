

<!doctype html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>neurotools.parallel module &mdash; neurotools 0 documentation</title>
    
    <link rel="stylesheet" href="_static/bizstyle.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/bizstyle.js"></script>
    <link rel="top" title="neurotools 0 documentation" href="index.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <!--[if lt IE 9]>
    <script type="text/javascript" src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">neurotools 0 documentation</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/neurotools.parallel.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-neurotools.parallel">
<span id="neurotools-parallel-module"></span><h1>neurotools.parallel module<a class="headerlink" href="#module-neurotools.parallel" title="Permalink to this headline">¶</a></h1>
<div class="section" id="parallel-tools">
<h2>Parallel tools<a class="headerlink" href="#parallel-tools" title="Permalink to this headline">¶</a></h2>
<p>Notes on why &#8220;parmap&#8221; and related functions are awkward in Python:</p>
<p>Python multiprocessing will raise &#8220;cannot pickle&#8221;
errors if you try to pass general functions as arguments to parallel
map. This flaw arises because python multiprocessing is achieved by
forking subprocesses that contain a full copy of the interpreter state,
mapped in memory with copy-on-write. (incidentally this is also why
you don&#8217;t want to load large datasets in worker processes, since each
process will load the dataset separately, consuming a large amount of
memory). Because functions defined after worker-pool initiation depend
on the interpreter state of the process in which they were defined, they
cannot be sent over to worker processes as we cannot guarantee in
general that the context they reference will exist in the worker process.
Consequentially, the only way to use a function with the &#8220;parmap&#8221;
function is to define it BEFORE the worker pool is initialized (or to
re-initialize the pool once it is defined). The function must be at
global scope.</p>
<p>Furthermore, the work-stealing pool model can only send back the return
values of function evaluations from the work queue &#8211; and it does so in
no particular order. Therefore, if we want to know which job corresponds
to which return value, we must return identifying information. In this
case wer return the job number.</p>
<p>The reason we cannot make a generic function that masks this &#8220;return the
job ID&#8221; issue is that we cannot pass an arbitrary function over to
the worker pool processes due to the aforementioned interpreter context
issue.</p>
<p>A more laborous workaround, which we might consider later, would be to
re-implement the work-stealing queue so that job IDs are automatically
preserved and communicated through inter-process communication.</p>
<p>This will not solve the problem of needing to define all functions used
with &#8220;parmap&#8221; before the working pool is initailized and at global scope,
but it will save us from having to manually track and return the job
number, which will lead to more readable and more reusable code.</p>
<dl class="function">
<dt id="neurotools.parallel.parmap">
<code class="descclassname">neurotools.parallel.</code><code class="descname">parmap</code><span class="sig-paren">(</span><em>f</em>, <em>problems</em>, <em>leavefree=1</em>, <em>fakeit=False</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/parallel.html#parmap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.parallel.parmap" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="neurotools.parallel.parmap_dict">
<code class="descclassname">neurotools.parallel.</code><code class="descname">parmap_dict</code><span class="sig-paren">(</span><em>f</em>, <em>problems</em>, <em>leavefree=1</em>, <em>fakeit=False</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/parallel.html#parmap_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.parallel.parmap_dict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="neurotools.parallel.parmap_enum">
<code class="descclassname">neurotools.parallel.</code><code class="descname">parmap_enum</code><span class="sig-paren">(</span><em>f</em>, <em>problems</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/parallel.html#parmap_enum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.parallel.parmap_enum" title="Permalink to this definition">¶</a></dt>
<dd><p>f must return an index as the first element in a tuple for this to work</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.parallel.reset_pool">
<code class="descclassname">neurotools.parallel.</code><code class="descname">reset_pool</code><span class="sig-paren">(</span><em>leavefree=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/parallel.html#reset_pool"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.parallel.reset_pool" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">neurotools 0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2015, mrule.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>