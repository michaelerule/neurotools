

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>neurotools.jobs.parallel module &mdash; Neurotools 2 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="neurotools.linalg package" href="neurotools.linalg.html" />
    <link rel="prev" title="neurotools.jobs.ndecorator module" href="neurotools.jobs.ndecorator.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Neurotools
          

          
          </a>

          
            
            
              <div class="version">
                2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">neurotools</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="neurotools.html">neurotools package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="neurotools.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="neurotools.encoding.html">neurotools.encoding package</a></li>
<li class="toctree-l4"><a class="reference internal" href="neurotools.gpu.html">neurotools.gpu package</a></li>
<li class="toctree-l4"><a class="reference internal" href="neurotools.graphics.html">neurotools.graphics package</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="neurotools.jobs.html">neurotools.jobs package</a><ul class="current">
<li class="toctree-l5 current"><a class="reference internal" href="neurotools.jobs.html#submodules">Submodules</a></li>
<li class="toctree-l5"><a class="reference internal" href="neurotools.jobs.html#module-neurotools.jobs">Module contents</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="neurotools.linalg.html">neurotools.linalg package</a></li>
<li class="toctree-l4"><a class="reference internal" href="neurotools.models.html">neurotools.models package</a></li>
<li class="toctree-l4"><a class="reference internal" href="neurotools.signal.html">neurotools.signal package</a></li>
<li class="toctree-l4"><a class="reference internal" href="neurotools.spatial.html">neurotools.spatial package</a></li>
<li class="toctree-l4"><a class="reference internal" href="neurotools.spikes.html">neurotools.spikes package</a></li>
<li class="toctree-l4"><a class="reference internal" href="neurotools.stats.html">neurotools.stats package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="neurotools.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="neurotools.html#module-neurotools">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Neurotools</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="modules.html">neurotools</a> &raquo;</li>
        
          <li><a href="neurotools.html">neurotools package</a> &raquo;</li>
        
          <li><a href="neurotools.jobs.html">neurotools.jobs package</a> &raquo;</li>
        
      <li>neurotools.jobs.parallel module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/neurotools.jobs.parallel.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-neurotools.jobs.parallel">
<span id="neurotools-jobs-parallel-module"></span><h1>neurotools.jobs.parallel module<a class="headerlink" href="#module-neurotools.jobs.parallel" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="neurotools.jobs.parallel.parmap">
<code class="descclassname">neurotools.jobs.parallel.</code><code class="descname">parmap</code><span class="sig-paren">(</span><em>f</em>, <em>problems</em>, <em>leavefree=1</em>, <em>debug=False</em>, <em>verbose=False</em>, <em>show_progress=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/jobs/parallel.html#parmap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.jobs.parallel.parmap" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallel implmenetation of map using multiprocessing</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (<em>function to apply</em><em>, </em><em>takes one argument and returns a tuple</em>) – (i,result) where i is the index into the problems</p></li>
<li><p><strong>problems</strong> (<em>list of arguments to f to evaulate in parallel</em>) – </p></li>
<li><p><strong>leavefree</strong> (<em>number of cores to leave open</em>) – </p></li>
<li><p><strong>debug</strong> (<em>if True</em><em>, </em><em>will run on a single core so exceptions get</em>) – handeled correctly</p></li>
<li><p><strong>verbose</strong> (<em>set to True to print out detailed logging information</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of results</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="neurotools.jobs.parallel.pararraymap">
<code class="descclassname">neurotools.jobs.parallel.</code><code class="descname">pararraymap</code><span class="sig-paren">(</span><em>function</em>, <em>problems</em>, <em>debug=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/jobs/parallel.html#pararraymap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.jobs.parallel.pararraymap" title="Permalink to this definition">¶</a></dt>
<dd><p>Parmap wrapper for common use-case with Numpy</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.jobs.parallel.parmap_dict">
<code class="descclassname">neurotools.jobs.parallel.</code><code class="descname">parmap_dict</code><span class="sig-paren">(</span><em>f</em>, <em>problems</em>, <em>leavefree=1</em>, <em>debug=False</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/jobs/parallel.html#parmap_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.jobs.parallel.parmap_dict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="neurotools.jobs.parallel.function_fingerprint">
<code class="descclassname">neurotools.jobs.parallel.</code><code class="descname">function_fingerprint</code><span class="sig-paren">(</span><em>f</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/jobs/parallel.html#function_fingerprint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.jobs.parallel.function_fingerprint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="neurotools.jobs.parallel.eval_from_cached">
<code class="descclassname">neurotools.jobs.parallel.</code><code class="descname">eval_from_cached</code><span class="sig-paren">(</span><em>fingerprint</em>, <em>args</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/jobs/parallel.html#eval_from_cached"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.jobs.parallel.eval_from_cached" title="Permalink to this definition">¶</a></dt>
<dd><p>Attempts to recompile a function from its source code, and store the
compiled result in the global dictionary <cite>__indirect_eval_fallback_cache</cite>.
It then attempts to call the function on the provided arguments.</p>
<p>This is one alternative way to pass newly-created functions to the worker
pool in parallel processing, if the usual built-in routines fail.</p>
<p>This can fail if the function closes over additional variables that were
not present at the time the worker-pool was initialized.</p>
<p>It can yield undefined results if the function uses mutable variables in
the global scope.</p>
<p>This cannot rebuild lambda expressions from source, but can use them if
they are stored in the global __indirect_eval_fallback_cache ahead of time.</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.jobs.parallel.parallel_indirect_wrapper">
<code class="descclassname">neurotools.jobs.parallel.</code><code class="descname">parallel_indirect_wrapper</code><span class="sig-paren">(</span><em>p</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/jobs/parallel.html#parallel_indirect_wrapper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.jobs.parallel.parallel_indirect_wrapper" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="neurotools.jobs.parallel.parallel_cached_wrapper">
<code class="descclassname">neurotools.jobs.parallel.</code><code class="descname">parallel_cached_wrapper</code><span class="sig-paren">(</span><em>p</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/jobs/parallel.html#parallel_cached_wrapper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.jobs.parallel.parallel_cached_wrapper" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="neurotools.jobs.parallel.parimap">
<code class="descclassname">neurotools.jobs.parallel.</code><code class="descname">parimap</code><span class="sig-paren">(</span><em>f</em>, <em>jobs</em>, <em>debug=False</em>, <em>force_cached=False</em>, <em>force_fallback=False</em>, <em>allow_fallback=True</em>, <em>verbose=False</em>, <em>show_progress=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/jobs/parallel.html#parimap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.jobs.parallel.parimap" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallel map routine.</p>
<p>In some cases and on some systems, user-defind functions don’t work with
the multiprocessing library.</p>
<p>This happens when the system is unable to “pickle” functions which were
defined after the worker pool was initiatlized.</p>
<p>There are two workarounds for this:</p>
<ol class="arabic simple">
<li><p>You can attempt to send the function source-code to the workers, and
rebuild from source within the workers. However, this is risky for two
reasons. (a) If your funcion closes over globals which were not defined
at the time the worker-pool was launched, these globals will be missing
and prevent re-compilation of the function. (b) Any mutable variables
that the function closes over might have a different state in the
worker threads (as I understand it).</p></li>
<li><p>You can also ensure that there is a pointer to the defined funcion in
the global workspace. Here, we store function pointers in the dictionary
‘__indirect_eval_fallback_cache’. Then, one can re-launch the worker
pool, and each worker will gain access to the compiled function via the
inhereted global scope (as I understand it).</p></li>
</ol>
<p>If normal parallel map fails, this routine will first try (1), and then (2).</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.jobs.parallel.close_pool">
<code class="descclassname">neurotools.jobs.parallel.</code><code class="descname">close_pool</code><span class="sig-paren">(</span><em>context=None</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/jobs/parallel.html#close_pool"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.jobs.parallel.close_pool" title="Permalink to this definition">¶</a></dt>
<dd><p>Safely halts the worker-pool. If worker threads are stuck,
then this function will hang. On the other hand, it avoids doing
anything violent to close workers.</p>
<dl class="field-list simple">
<dt class="field-odd">Other Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>leavefree</strong> (<cite>int</cite>, default 1) – How many cores to “leave free”; The pool size will be the number of
system cores minus this value</p></li>
<li><p><strong>context</strong> (<em>python context, default None</em>) – This context will be used for all workers in the pool</p></li>
<li><p><strong>verbose</strong> (<cite>bool</cite>, default False) – Whether to print logging information.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="neurotools.jobs.parallel.reset_pool">
<code class="descclassname">neurotools.jobs.parallel.</code><code class="descname">reset_pool</code><span class="sig-paren">(</span><em>leavefree=None</em>, <em>context=None</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/jobs/parallel.html#reset_pool"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.jobs.parallel.reset_pool" title="Permalink to this definition">¶</a></dt>
<dd><p>Safely halts and restarts the worker-pool. If worker threads are stuck,
then this function will hang. On the other hand, it avoids doing
anything violent to close workers.</p>
<dl class="field-list simple">
<dt class="field-odd">Other Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>leavefree</strong> (<cite>int</cite>, default 1) – How many cores to “leave free”; The pool size will be the number of
system cores minus this value</p></li>
<li><p><strong>context</strong> (<em>python context, default None</em>) – This context will be used for all workers in the pool</p></li>
<li><p><strong>verbose</strong> (<cite>bool</cite>, default False) – Whether to print logging information.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="neurotools.jobs.parallel.parallel_error_handling">
<code class="descclassname">neurotools.jobs.parallel.</code><code class="descname">parallel_error_handling</code><span class="sig-paren">(</span><em>f</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/jobs/parallel.html#parallel_error_handling"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.jobs.parallel.parallel_error_handling" title="Permalink to this definition">¶</a></dt>
<dd><p>We can’t really use exception handling in parallel calls.
This is a wrapper to just catch errors to prevent them from
propagating up.</p>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="neurotools.linalg.html" class="btn btn-neutral float-right" title="neurotools.linalg package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="neurotools.jobs.ndecorator.html" class="btn btn-neutral float-left" title="neurotools.jobs.ndecorator module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2017, M Rule.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>