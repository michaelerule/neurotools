

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>neurotools.models.rbm.rbm_utils.rbm module &mdash; Neurotools 2 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="neurotools.models.rbm.rbm_utils.stutils module" href="neurotools.models.rbm.rbm_utils.stutils.html" />
    <link rel="prev" title="neurotools.models.rbm.rbm_utils package" href="neurotools.models.rbm.rbm_utils.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Neurotools
          

          
          </a>

          
            
            
              <div class="version">
                2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">neurotools</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="neurotools.html">neurotools package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="neurotools.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="neurotools.encoding.html">neurotools.encoding package</a></li>
<li class="toctree-l4"><a class="reference internal" href="neurotools.gpu.html">neurotools.gpu package</a></li>
<li class="toctree-l4"><a class="reference internal" href="neurotools.graphics.html">neurotools.graphics package</a></li>
<li class="toctree-l4"><a class="reference internal" href="neurotools.jobs.html">neurotools.jobs package</a></li>
<li class="toctree-l4"><a class="reference internal" href="neurotools.linalg.html">neurotools.linalg package</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="neurotools.models.html">neurotools.models package</a><ul class="current">
<li class="toctree-l5 current"><a class="reference internal" href="neurotools.models.html#subpackages">Subpackages</a></li>
<li class="toctree-l5"><a class="reference internal" href="neurotools.models.html#submodules">Submodules</a></li>
<li class="toctree-l5"><a class="reference internal" href="neurotools.models.html#module-neurotools.models">Module contents</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="neurotools.signal.html">neurotools.signal package</a></li>
<li class="toctree-l4"><a class="reference internal" href="neurotools.spatial.html">neurotools.spatial package</a></li>
<li class="toctree-l4"><a class="reference internal" href="neurotools.spikes.html">neurotools.spikes package</a></li>
<li class="toctree-l4"><a class="reference internal" href="neurotools.stats.html">neurotools.stats package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="neurotools.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="neurotools.html#module-neurotools">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Neurotools</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="modules.html">neurotools</a> &raquo;</li>
        
          <li><a href="neurotools.html">neurotools package</a> &raquo;</li>
        
          <li><a href="neurotools.models.html">neurotools.models package</a> &raquo;</li>
        
          <li><a href="neurotools.models.rbm.html">neurotools.models.rbm package</a> &raquo;</li>
        
          <li><a href="neurotools.models.rbm.rbm_utils.html">neurotools.models.rbm.rbm_utils package</a> &raquo;</li>
        
      <li>neurotools.models.rbm.rbm_utils.rbm module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/neurotools.models.rbm.rbm_utils.rbm.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-neurotools.models.rbm.rbm_utils.rbm">
<span id="neurotools-models-rbm-rbm-utils-rbm-module"></span><h1>neurotools.models.rbm.rbm_utils.rbm module<a class="headerlink" href="#module-neurotools.models.rbm.rbm_utils.rbm" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="neurotools.models.rbm.rbm_utils.rbm.LoadRBM">
<code class="descclassname">neurotools.models.rbm.rbm_utils.rbm.</code><code class="descname">LoadRBM</code><span class="sig-paren">(</span><em>fname</em>, <em>beta=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/models/rbm/rbm_utils/rbm.html#LoadRBM"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.models.rbm.rbm_utils.rbm.LoadRBM" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="neurotools.models.rbm.rbm_utils.rbm.RBM">
<em class="property">class </em><code class="descclassname">neurotools.models.rbm.rbm_utils.rbm.</code><code class="descname">RBM</code><span class="sig-paren">(</span><em>input=None</em>, <em>n_visible=784</em>, <em>n_hidden=500</em>, <em>W=None</em>, <em>hbias=None</em>, <em>vbias=None</em>, <em>numpy_rng=None</em>, <em>theano_rng=None</em>, <em>reg_weight=0.0</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/models/rbm/rbm_utils/rbm.html#RBM"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.models.rbm.rbm_utils.rbm.RBM" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Restricted Boltzmann Machine (RBM)</p>
<dl class="method">
<dt id="neurotools.models.rbm.rbm_utils.rbm.RBM.free_energy">
<code class="descname">free_energy</code><span class="sig-paren">(</span><em>v_sample</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/models/rbm/rbm_utils/rbm.html#RBM.free_energy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.models.rbm.rbm_utils.rbm.RBM.free_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to compute the free energy</p>
</dd></dl>

<dl class="method">
<dt id="neurotools.models.rbm.rbm_utils.rbm.RBM.propup">
<code class="descname">propup</code><span class="sig-paren">(</span><em>vis</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/models/rbm/rbm_utils/rbm.html#RBM.propup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.models.rbm.rbm_utils.rbm.RBM.propup" title="Permalink to this definition">¶</a></dt>
<dd><p>This function propagates the visible units activation upwards to
the hidden units</p>
<p>Note that we return also the pre-sigmoid activation of the
layer. As it will turn out later, due to how Theano deals with
optimizations, this symbolic variable will be needed to write
down a more stable computational graph (see details in the
reconstruction cost function)</p>
</dd></dl>

<dl class="method">
<dt id="neurotools.models.rbm.rbm_utils.rbm.RBM.sample_h_given_v">
<code class="descname">sample_h_given_v</code><span class="sig-paren">(</span><em>v0_sample</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/models/rbm/rbm_utils/rbm.html#RBM.sample_h_given_v"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.models.rbm.rbm_utils.rbm.RBM.sample_h_given_v" title="Permalink to this definition">¶</a></dt>
<dd><p>This function infers state of hidden units given visible units</p>
</dd></dl>

<dl class="method">
<dt id="neurotools.models.rbm.rbm_utils.rbm.RBM.propdown">
<code class="descname">propdown</code><span class="sig-paren">(</span><em>hid</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/models/rbm/rbm_utils/rbm.html#RBM.propdown"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.models.rbm.rbm_utils.rbm.RBM.propdown" title="Permalink to this definition">¶</a></dt>
<dd><p>This function propagates the hidden units activation downwards to
the visible units</p>
<p>Note that we return also the pre_sigmoid_activation of the
layer. As it will turn out later, due to how Theano deals with
optimizations, this symbolic variable will be needed to write
down a more stable computational graph (see details in the
reconstruction cost function)</p>
</dd></dl>

<dl class="method">
<dt id="neurotools.models.rbm.rbm_utils.rbm.RBM.sample_v_given_h">
<code class="descname">sample_v_given_h</code><span class="sig-paren">(</span><em>h0_sample</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/models/rbm/rbm_utils/rbm.html#RBM.sample_v_given_h"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.models.rbm.rbm_utils.rbm.RBM.sample_v_given_h" title="Permalink to this definition">¶</a></dt>
<dd><p>This function infers state of visible units given hidden units</p>
</dd></dl>

<dl class="method">
<dt id="neurotools.models.rbm.rbm_utils.rbm.RBM.gibbs_hvh">
<code class="descname">gibbs_hvh</code><span class="sig-paren">(</span><em>h0_sample</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/models/rbm/rbm_utils/rbm.html#RBM.gibbs_hvh"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.models.rbm.rbm_utils.rbm.RBM.gibbs_hvh" title="Permalink to this definition">¶</a></dt>
<dd><p>This function implements one step of Gibbs sampling,
starting from the hidden state</p>
</dd></dl>

<dl class="method">
<dt id="neurotools.models.rbm.rbm_utils.rbm.RBM.gibbs_vhv">
<code class="descname">gibbs_vhv</code><span class="sig-paren">(</span><em>v0_sample</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/models/rbm/rbm_utils/rbm.html#RBM.gibbs_vhv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.models.rbm.rbm_utils.rbm.RBM.gibbs_vhv" title="Permalink to this definition">¶</a></dt>
<dd><p>This function implements one step of Gibbs sampling,
starting from the visible state</p>
</dd></dl>

<dl class="method">
<dt id="neurotools.models.rbm.rbm_utils.rbm.RBM.mean_h_given_v">
<code class="descname">mean_h_given_v</code><span class="sig-paren">(</span><em>v0_sample</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/models/rbm/rbm_utils/rbm.html#RBM.mean_h_given_v"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.models.rbm.rbm_utils.rbm.RBM.mean_h_given_v" title="Permalink to this definition">¶</a></dt>
<dd><p>This function infers state of hidden units given visible units</p>
</dd></dl>

<dl class="method">
<dt id="neurotools.models.rbm.rbm_utils.rbm.RBM.get_cost_updates">
<code class="descname">get_cost_updates</code><span class="sig-paren">(</span><em>lr=0.1</em>, <em>persistent=None</em>, <em>k=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/models/rbm/rbm_utils/rbm.html#RBM.get_cost_updates"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.models.rbm.rbm_utils.rbm.RBM.get_cost_updates" title="Permalink to this definition">¶</a></dt>
<dd><p>This functions implements one step of CD-k or PCD-k</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>lr</strong> – learning rate used to train the RBM</li>
<li><strong>persistent</strong> – None for CD. For PCD, shared variable
containing old state of Gibbs chain. This must be a shared
variable of size (batch size, number of hidden units).</li>
<li><strong>k</strong> – number of Gibbs steps to do in CD-k/PCD-k</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns a proxy for the cost and the updates dictionary. The
dictionary contains the update rules for weights and biases but
also an update of the shared variable used to store the persistent
chain, if one is used.</p>
</dd></dl>

<dl class="method">
<dt id="neurotools.models.rbm.rbm_utils.rbm.RBM.get_pseudo_likelihood_cost">
<code class="descname">get_pseudo_likelihood_cost</code><span class="sig-paren">(</span><em>updates</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/models/rbm/rbm_utils/rbm.html#RBM.get_pseudo_likelihood_cost"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.models.rbm.rbm_utils.rbm.RBM.get_pseudo_likelihood_cost" title="Permalink to this definition">¶</a></dt>
<dd><p>Stochastic approximation to the pseudo-likelihood</p>
</dd></dl>

<dl class="method">
<dt id="neurotools.models.rbm.rbm_utils.rbm.RBM.get_reconstruction_cost">
<code class="descname">get_reconstruction_cost</code><span class="sig-paren">(</span><em>updates</em>, <em>pre_sigmoid_nv</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/models/rbm/rbm_utils/rbm.html#RBM.get_reconstruction_cost"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.models.rbm.rbm_utils.rbm.RBM.get_reconstruction_cost" title="Permalink to this definition">¶</a></dt>
<dd><p>Approximation to the reconstruction error</p>
<p>Note that this function requires the pre-sigmoid activation as
input.  To understand why this is so you need to understand a
bit about how Theano works. Whenever you compile a Theano
function, the computational graph that you pass as input gets
optimized for speed and stability.  This is done by changing
several parts of the subgraphs with others.  One such
optimization expresses terms of the form log(sigmoid(x)) in
terms of softplus.  We need this optimization for the
cross-entropy since sigmoid of numbers larger than 30. (or
even less then that) turn to 1. and numbers smaller than
-30. turn to 0 which in terms will force theano to compute
log(0) and therefore we will get either -inf or NaN as
cost. If the value is expressed in terms of softplus we do not
get this undesirable behaviour. This optimization usually
works fine, but here we have a special case. The sigmoid is
applied inside the scan op, while the log is
outside. Therefore Theano will only see log(scan(..)) instead
of log(sigmoid(..)) and will not apply the wanted
optimization. We can not go and replace the sigmoid in scan
with something else also, because this only needs to be done
on the last step. Therefore the easiest and more efficient way
is to get also the pre-sigmoid activation as an output of
scan, and apply both the log and sigmoid outside scan such
that Theano can catch and optimize the expression.</p>
</dd></dl>

<dl class="method">
<dt id="neurotools.models.rbm.rbm_utils.rbm.RBM.train">
<code class="descname">train</code><span class="sig-paren">(</span><em>data_x</em>, <em>learning_rate=0.1</em>, <em>training_epochs=15</em>, <em>batch_size=20</em>, <em>output_all=None</em>, <em>output_final=None</em>, <em>cd_steps=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/models/rbm/rbm_utils/rbm.html#RBM.train"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.models.rbm.rbm_utils.rbm.RBM.train" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>data_x</strong> – the training set</li>
<li><strong>learning_rate</strong> – learning rate used for training the RBM</li>
<li><strong>training_epochs</strong> – number of epochs used for training</li>
<li><strong>batch_size</strong> – size of a batch used to train the RBM</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="neurotools.models.rbm.rbm_utils.rbm.RBM.sample">
<code class="descname">sample</code><span class="sig-paren">(</span><em>test_x</em>, <em>output_file='rbm_samples.npy'</em>, <em>n_chains=20</em>, <em>n_samples=10</em>, <em>plot_every=1000</em>, <em>include_hidden=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/models/rbm/rbm_utils/rbm.html#RBM.sample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.models.rbm.rbm_utils.rbm.RBM.sample" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>test_x</strong> – the test set, used for the starting points</li>
<li><strong>n_chains</strong> – <ol class="loweralpha" start="14">
<li>of parallel Gibbs chains to be used for sampling</li>
</ol>
</li>
<li><strong>n_samples</strong> – number of samples to plot for each chain</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="neurotools.models.rbm.rbm_utils.rbm.RBM.vis_energy">
<code class="descname">vis_energy</code><span class="sig-paren">(</span><em>s</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/models/rbm/rbm_utils/rbm.html#RBM.vis_energy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.models.rbm.rbm_utils.rbm.RBM.vis_energy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="neurotools.models.rbm.rbm_utils.rbm.RBM.savenp">
<code class="descname">savenp</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/models/rbm/rbm_utils/rbm.html#RBM.savenp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.models.rbm.rbm_utils.rbm.RBM.savenp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="neurotools.models.rbm.rbm_utils.stutils.html" class="btn btn-neutral float-right" title="neurotools.models.rbm.rbm_utils.stutils module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="neurotools.models.rbm.rbm_utils.html" class="btn btn-neutral float-left" title="neurotools.models.rbm.rbm_utils package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, M Rule

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>