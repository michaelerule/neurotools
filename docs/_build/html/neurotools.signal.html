<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>neurotools.signal package &mdash; Neurotools 2 documentation</title><link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="neurotools.signal.coherence module" href="neurotools.signal.coherence.html" />
    <link rel="prev" title="Neurotools" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> Neurotools<img src="_static/logo1.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                2
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Subpackages:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">signal</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="neurotools.signal.coherence.html">neurotools.signal.coherence module</a></li>
<li class="toctree-l3"><a class="reference internal" href="neurotools.signal.conv.html">neurotools.signal.conv module</a></li>
<li class="toctree-l3"><a class="reference internal" href="neurotools.signal.morlet.html">neurotools.signal.morlet module</a></li>
<li class="toctree-l3"><a class="reference internal" href="neurotools.signal.multitaper.html">neurotools.signal.multitaper module</a></li>
<li class="toctree-l3"><a class="reference internal" href="neurotools.signal.ppc.html">neurotools.signal.ppc module</a></li>
<li class="toctree-l3"><a class="reference internal" href="neurotools.signal.savitskygolay.html">neurotools.signal.savitskygolay module</a></li>
<li class="toctree-l3"><a class="reference internal" href="neurotools.signal.sde.html">neurotools.signal.sde module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-neurotools.signal">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="neurotools.stats.html">stats</a></li>
<li class="toctree-l1"><a class="reference internal" href="neurotools.spatial.html">spatial</a></li>
<li class="toctree-l1"><a class="reference internal" href="neurotools.spikes.html">spikes</a></li>
<li class="toctree-l1"><a class="reference internal" href="neurotools.graphics.html">graphics</a></li>
<li class="toctree-l1"><a class="reference internal" href="neurotools.linalg.html">linalg</a></li>
<li class="toctree-l1"><a class="reference internal" href="neurotools.jobs.html">jobs</a></li>
<li class="toctree-l1"><a class="reference internal" href="neurotools.jobs.html">util</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Neurotools</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a></li>
      <li class="breadcrumb-item active">neurotools.signal package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/neurotools.signal.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="neurotools-signal-package">
<h1>neurotools.signal package<a class="headerlink" href="#neurotools-signal-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="neurotools.signal.coherence.html">neurotools.signal.coherence module</a></li>
<li class="toctree-l1"><a class="reference internal" href="neurotools.signal.conv.html">neurotools.signal.conv module</a></li>
<li class="toctree-l1"><a class="reference internal" href="neurotools.signal.morlet.html">neurotools.signal.morlet module</a></li>
<li class="toctree-l1"><a class="reference internal" href="neurotools.signal.multitaper.html">neurotools.signal.multitaper module</a></li>
<li class="toctree-l1"><a class="reference internal" href="neurotools.signal.ppc.html">neurotools.signal.ppc module</a></li>
<li class="toctree-l1"><a class="reference internal" href="neurotools.signal.savitskygolay.html">neurotools.signal.savitskygolay module</a></li>
<li class="toctree-l1"><a class="reference internal" href="neurotools.signal.sde.html">neurotools.signal.sde module</a></li>
</ul>
</div>
</div>
<div class="section" id="module-neurotools.signal">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-neurotools.signal" title="Permalink to this headline">¶</a></h2>
<p>Routines for signal processing.</p>
<dl class="function">
<dt id="neurotools.signal.geometric_window">
<code class="descclassname">neurotools.signal.</code><code class="descname">geometric_window</code><span class="sig-paren">(</span><em>c</em>, <em>w</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#geometric_window"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.geometric_window" title="Permalink to this definition">¶</a></dt>
<dd><p>Gemoetrically center a frequency window</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>c</strong> (<em>float</em>) – Center of frequency window</li>
<li><strong>w</strong> (<em>float</em>) – width of frequency window</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>fa</strong> (<em>float</em>) – low-frequency cutoff</li>
<li><strong>fb</strong> (<em>float</em>) – high-frequency cutoff</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.gaussian_kernel">
<code class="descclassname">neurotools.signal.</code><code class="descname">gaussian_kernel</code><span class="sig-paren">(</span><em>sigma</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#gaussian_kernel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.gaussian_kernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate 1D Guassian kernel for smoothing</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>sigma</strong> (<em>positive float</em>) – Standard deviation of kernel. Kernel size is
automatically adjusted to ceil(sigma*2)*2+1</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>K</strong> – normalized Gaussian kernel</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">vector</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.gaussian_smooth">
<code class="descclassname">neurotools.signal.</code><code class="descname">gaussian_smooth</code><span class="sig-paren">(</span><em>x</em>, <em>sigma</em>, <em>mode='same'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#gaussian_smooth"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.gaussian_smooth" title="Permalink to this definition">¶</a></dt>
<dd><p>Smooth signal x with gaussian of standard deviation
sigma, using edge-clamped boundary conditions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sigma</strong> (<em>positive float</em>) – Standard deviation of Gaussian smoothing kernel.</li>
<li><strong>x</strong> (<em>1D np.array</em>) – Signal to filter.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">smoothed signal</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.circular_gaussian_smooth">
<code class="descclassname">neurotools.signal.</code><code class="descname">circular_gaussian_smooth</code><span class="sig-paren">(</span><em>x</em>, <em>sigma</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#circular_gaussian_smooth"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.circular_gaussian_smooth" title="Permalink to this definition">¶</a></dt>
<dd><p>Smooth signal x with gaussian of standard deviation sigma
Circularly wrapped using Fourier transform</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>sigma</strong> (<em>standard deviation</em>) – </li>
<li><strong>x</strong> (<em>1D array-like signal</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.circular_gaussian_smooth_2D">
<code class="descclassname">neurotools.signal.</code><code class="descname">circular_gaussian_smooth_2D</code><span class="sig-paren">(</span><em>x</em>, <em>sigma</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#circular_gaussian_smooth_2D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.circular_gaussian_smooth_2D" title="Permalink to this definition">¶</a></dt>
<dd><p>Smooth signal x with gaussian of standard deviation sigma
Circularly wrapped using Fourier transform</p>
<p>sigma: standard deviation
x: 2D array-like signal</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<em>ndarray</em>) – Smoothing is performed over the last two dimensions,
which should have the same length</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.linear_cosine_basis">
<code class="descclassname">neurotools.signal.</code><code class="descname">linear_cosine_basis</code><span class="sig-paren">(</span><em>TIMERES=100</em>, <em>NBASIS=10</em>, <em>normalize=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#linear_cosine_basis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.linear_cosine_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Cosine basis tiling unit interval</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.circular_cosine_basis">
<code class="descclassname">neurotools.signal.</code><code class="descname">circular_cosine_basis</code><span class="sig-paren">(</span><em>N</em>, <em>T</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#circular_cosine_basis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.circular_cosine_basis" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>N</strong> (<em>number of basis functions</em>) – </li>
<li><strong>T</strong> (<em>grid resolution</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Circularly-wrapped cosine basis</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.unitscale">
<code class="descclassname">neurotools.signal.</code><code class="descname">unitscale</code><span class="sig-paren">(</span><em>signal</em>, <em>axis=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#unitscale"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.unitscale" title="Permalink to this definition">¶</a></dt>
<dd><p>Rescales <cite>signal</cite> so that its minimum is 0 and its maximum is 1.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>signal</strong> – array-like real-valued signal</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Rescaled signal-min(signal)/(max(signal)-min(signal))</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">signal</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.topercentiles">
<code class="descclassname">neurotools.signal.</code><code class="descname">topercentiles</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#topercentiles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.topercentiles" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="neurotools.signal.local_maxima">
<code class="descclassname">neurotools.signal.</code><code class="descname">local_maxima</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#local_maxima"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.local_maxima" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns signal index and values at those indecies</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.local_minima">
<code class="descclassname">neurotools.signal.</code><code class="descname">local_minima</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#local_minima"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.local_minima" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns signal index and values at those indecies for all local minima.
See local_maxima</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.amp">
<code class="descclassname">neurotools.signal.</code><code class="descname">amp</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#amp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.amp" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts amplitude envelope using Hilbert transform. X must be narrow
band. No padding is performed so watch out for boundary effects</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<em>sequence</em>) – numeric time-series data</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">abs(hilbert(x))</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">result</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.get_snips">
<code class="descclassname">neurotools.signal.</code><code class="descname">get_snips</code><span class="sig-paren">(</span><em>signal</em>, <em>times</em>, <em>window</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#get_snips"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.get_snips" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract snippits of a time series surronding a list of times. Typically
used for spike-triggered statistics</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.triggered_average">
<code class="descclassname">neurotools.signal.</code><code class="descname">triggered_average</code><span class="sig-paren">(</span><em>signal</em>, <em>times</em>, <em>window</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#triggered_average"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.triggered_average" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="neurotools.signal.get_triggered_stats">
<code class="descclassname">neurotools.signal.</code><code class="descname">get_triggered_stats</code><span class="sig-paren">(</span><em>signal</em>, <em>times</em>, <em>window</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#get_triggered_stats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.get_triggered_stats" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a statistical summary of data in length window
around time points.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>signal</strong> (<em>one-dimensional array-like</em>) – Signal to summarize</li>
<li><strong>times</strong> (<em>one-dimensionan array-like</em>) – list of time-points around which to summarize (in frames)</li>
<li><strong>window</strong> (<em>positive int</em>) – window (in frames) around each time-point to use for statistical
summary</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><em>means</em> – means of <cite>signal</cite> for all time-windows specified in <cite>times</cite></li>
<li><em>standard-deviations</em> – std of <cite>signal</cite> for all time-windows specified in <cite>times</cite></li>
<li><em>standard-erros</em> – standard errors of the mean of <cite>signal</cite> for all time-windows
specified in <cite>times</cite></li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.padout">
<code class="descclassname">neurotools.signal.</code><code class="descname">padout</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#padout"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.padout" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a reflected version of a 1-dimensional signal. This can be
handy for achieving reflected boundary conditions in algorithms that
do not support this condition by default.</p>
<p>The original data is placed in the middle, between the mirrord copies.
Use the function “padin” to strip the padding</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.padin">
<code class="descclassname">neurotools.signal.</code><code class="descname">padin</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#padin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.padin" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes padding added by the <cite>padout</cite> function;
<cite>padin</cite> and <cite>padout</cite> together are used to control the
boundary condtitions for filtering. See the documentation
for padout for details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<em>array-like</em>) – Data array produced by the <cite>padout function</cite></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">data with edge padding removed</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">np.array</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.nonnegative_bandpass_filter">
<code class="descclassname">neurotools.signal.</code><code class="descname">nonnegative_bandpass_filter</code><span class="sig-paren">(</span><em>data</em>, <em>fa=None</em>, <em>fb=None</em>, <em>Fs=1000.0</em>, <em>order=4</em>, <em>zerophase=True</em>, <em>bandstop=False</em>, <em>offset=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#nonnegative_bandpass_filter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.nonnegative_bandpass_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>For filtering data that must remain non-negative. Due to ringing
conventional fitering can create values less than zero for non-
negative real inputs. This may be unrealistic for some data.</p>
<p>To compensate, this performs the filtering on the natural
logarithm of the input data. For small numbers, this can lead to
numeric underflow, so an offset parameter (default 1) is added
to the data for stability.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>(</strong><strong>ndarray</strong><strong>)</strong> (<em>data</em>) – data, filtering performed over last dimension</li>
<li><strong>(</strong><strong>number</strong><strong>)</strong> (<em>fb</em>) – low-freq cutoff Hz. If none, lowpass at fb</li>
<li><strong>(</strong><strong>number</strong><strong>)</strong> – high-freq cutoff Hz. If none, highpass at fa</li>
<li><strong>(</strong><strong>int</strong><strong>)</strong> (<em>Fs</em>) – Sample rate in Hz</li>
<li><strong>(</strong><strong>1..6</strong><strong>)</strong> (<em>order</em>) – butterworth filter order. Default 4</li>
<li><strong>(</strong><strong>boolean</strong><strong>)</strong> (<em>bandstop</em>) – Use forward-backward filtering? (true)</li>
<li><strong>(</strong><strong>boolean</strong><strong>)</strong> – Do band-stop rather than band-pass</li>
<li><strong>(</strong><strong>positive number</strong><strong>)</strong> (<em>offset</em>) – Offset data to avoid underflow (1)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Filtered signal</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">filtered</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.pad_signal">
<code class="descclassname">neurotools.signal.</code><code class="descname">pad_signal</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#pad_signal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.pad_signal" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="neurotools.signal.bandpass_filter">
<code class="descclassname">neurotools.signal.</code><code class="descname">bandpass_filter</code><span class="sig-paren">(</span><em>data</em>, <em>fa=None</em>, <em>fb=None</em>, <em>Fs=1000.0</em>, <em>order=4</em>, <em>zerophase=True</em>, <em>bandstop=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#bandpass_filter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.bandpass_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>IF fa is None, assumes lowpass with cutoff fb
IF fb is None, assume highpass with cutoff fa
Array can be any dimension, filtering performed over last dimension</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>data</strong> (<em>ndarray</em>) – data, filtering performed over last dimension</li>
<li><strong>fa</strong> (<em>number</em>) – low-frequency cutoff. If none, highpass at fb</li>
<li><strong>fb</strong> (<em>number</em>) – high-frequency cutoff. If none, lowpass at fa</li>
<li><strong>order</strong> (<em>1..6</em>) – butterworth filter order. Default 4</li>
<li><strong>zerophase</strong> (<em>boolean</em>) – Use forward-backward filtering? (true)</li>
<li><strong>bandstop</strong> (<em>boolean</em>) – Do band-stop rather than band-pass</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.box_filter">
<code class="descclassname">neurotools.signal.</code><code class="descname">box_filter</code><span class="sig-paren">(</span><em>data</em>, <em>smoothat</em>, <em>padmode='reflect'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#box_filter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.box_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Smooths data by convolving with a size smoothat box
provide smoothat in units of frames i.e. samples (not ms or seconds)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>np.array</em>) – One-dimensional numpy array of the signal to be filtred</li>
<li><strong>window</strong> (<em>positive int</em>) – Filtering window length in samples</li>
<li><strong>mode</strong> (<em>string</em><em>, </em><em>default 'same'</em>) – If ‘same’, the returned signal will have the same time-base and
length as the original signal. if ‘valid’, edges which do not
have the full window length will be trimmed</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">One-dimensional filtered signal</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">np.array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.median_filter">
<code class="descclassname">neurotools.signal.</code><code class="descname">median_filter</code><span class="sig-paren">(</span><em>x</em>, <em>window=100</em>, <em>mode='same'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#median_filter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.median_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Filters a signal by calculating the median in a sliding window of
width ‘window’</p>
<dl class="docutils">
<dt>mode=’same’ will compute median even at the edges, where a full window</dt>
<dd>is not available</dd>
<dt>mode=’valid’ will compute median only at points where the full window</dt>
<dd>is available</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>np.array</em>) – One-dimensional numpy array of the signal to be filtred</li>
<li><strong>window</strong> (<em>positive int</em>) – Filtering window length in samples</li>
<li><strong>mode</strong> (<em>string</em><em>, </em><em>default 'same'</em>) – If ‘same’, the returned signal will have the same time-base and
length as the original signal. if ‘valid’, edges which do not
have the full window length will be trimmed</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">One-dimensional filtered signal</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">np.array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.percentile_filter">
<code class="descclassname">neurotools.signal.</code><code class="descname">percentile_filter</code><span class="sig-paren">(</span><em>x</em>, <em>pct</em>, <em>window=100</em>, <em>mode='same'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#percentile_filter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.percentile_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Filters a signal by calculating the median in a sliding window of
width ‘window’</p>
<dl class="docutils">
<dt>mode=’same’ will compute median even at the edges, where a full window</dt>
<dd>is not available</dd>
<dt>mode=’valid’ will compute median only at points where the full window</dt>
<dd>is available</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>np.array</em>) – One-dimensional numpy array of the signal to be filtred</li>
<li><strong>pct</strong> (<em>float in 0..100</em>) – Percentile to apply</li>
<li><strong>window</strong> (<em>positive int</em>) – Filtering window length in samples</li>
<li><strong>mode</strong> (<em>string</em><em>, </em><em>default 'same'</em>) – If ‘same’, the returned signal will have the same time-base and
length as the original signal. if ‘valid’, edges which do not
have the full window length will be trimmed</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">One-dimensional filtered signal</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">np.array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.variance_filter">
<code class="descclassname">neurotools.signal.</code><code class="descname">variance_filter</code><span class="sig-paren">(</span><em>x</em>, <em>window=100</em>, <em>mode='same'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#variance_filter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.variance_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts signal variance in a sliding window</p>
<p>mode=’same’ will compute median even at the edges, where a full window
is not available</p>
<p>mode=’valid’ will compute median only at points where the full window
is available</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>np.array</em>) – One-dimensional numpy array of the signal to be filtred</li>
<li><strong>window</strong> (<em>positive int</em>) – Filtering window length in samples</li>
<li><strong>mode</strong> (<em>string</em><em>, </em><em>default 'same'</em>) – If ‘same’, the returned signal will have the same time-base and
length as the original signal. if ‘valid’, edges which do not
have the full window length will be trimmed</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">One-dimensional filtered signal</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">np.array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.rewrap">
<code class="descclassname">neurotools.signal.</code><code class="descname">rewrap</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#rewrap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.rewrap" title="Permalink to this definition">¶</a></dt>
<dd><p>Used to handle wraparound when getting phase derivatives.
See pdiff.</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.pdiff">
<code class="descclassname">neurotools.signal.</code><code class="descname">pdiff</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#pdiff"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.pdiff" title="Permalink to this definition">¶</a></dt>
<dd><p>Take the derivative of a sequence of phases.
Times when this derivative wraps around form 0 to 2*np.pi are correctly
handeled.</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.pghilbert">
<code class="descclassname">neurotools.signal.</code><code class="descname">pghilbert</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#pghilbert"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.pghilbert" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract phase gradient using the hilbert transform. See also pdiff.</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.fudge_derivative">
<code class="descclassname">neurotools.signal.</code><code class="descname">fudge_derivative</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#fudge_derivative"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.fudge_derivative" title="Permalink to this definition">¶</a></dt>
<dd><p>Discretely differentiating a signal reduces its signal by one sample.
In some cases, this may be undesirable. It also creates ambiguity as
the sample times of the differentiated signal occur halfway between the
sample times of the original signal. This procedure uses averaging to
move the sample times of a differentiated signal back in line with the
original.</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.ifreq">
<code class="descclassname">neurotools.signal.</code><code class="descname">ifreq</code><span class="sig-paren">(</span><em>x</em>, <em>Fs=1000</em>, <em>mode='pad'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#ifreq"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.ifreq" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract the instantaneous frequency from a narrow-band signal using
the Hilbert transform.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Fs</strong> (<em>int</em>) – defaults to 1000</li>
<li><strong>mode</strong> (<em>str</em>) – ‘pad’ will return a signal of the original length
‘valid’ will return a signal 1 sample shorter, with derivative
computed between each pair od points in the original signal.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.unwrap">
<code class="descclassname">neurotools.signal.</code><code class="descname">unwrap</code><span class="sig-paren">(</span><em>h</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#unwrap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.unwrap" title="Permalink to this definition">¶</a></dt>
<dd><p>Unwraps a sequences of phase measurements so that rather than
ranging from 0 to 2*np.pi, the values increase (or decrease) continuously.</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.ang">
<code class="descclassname">neurotools.signal.</code><code class="descname">ang</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#ang"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.ang" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses the Hilbert transform to extract the phase of x. X should be
narrow-band. The signal is not padded, so be wary of boundary effects.</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.randband">
<code class="descclassname">neurotools.signal.</code><code class="descname">randband</code><span class="sig-paren">(</span><em>N</em>, <em>fa=None</em>, <em>fb=None</em>, <em>Fs=1000</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#randband"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.randband" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns Gaussian random noise band-pass filtered between fa and fb.</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.arenear">
<code class="descclassname">neurotools.signal.</code><code class="descname">arenear</code><span class="sig-paren">(</span><em>b</em>, <em>K=5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#arenear"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.arenear" title="Permalink to this definition">¶</a></dt>
<dd><p>Expand a boolean/binary sequence by K samples in each direction.
See “aresafe”</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.aresafe">
<code class="descclassname">neurotools.signal.</code><code class="descname">aresafe</code><span class="sig-paren">(</span><em>b</em>, <em>K=5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#aresafe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.aresafe" title="Permalink to this definition">¶</a></dt>
<dd><p>Contract a boolean/binary sequence by K samples in each direction.
For example, you may want to test for a condition, but avoid samples
close to edges in that condition.</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.get_edges">
<code class="descclassname">neurotools.signal.</code><code class="descname">get_edges</code><span class="sig-paren">(</span><em>signal</em>, <em>pad_edges=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#get_edges"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.get_edges" title="Permalink to this definition">¶</a></dt>
<dd><p>Assuming a binary signal, get the start and stop times of each
treatch of “1s”</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>signal</strong> (<em>1-dimensional array-like</em>) – </td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Other Parameters:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><strong>pad_edges</strong> (<em>True</em>) – Should we treat blocks that start or stop at the beginning or end
of the signal as valid?</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">2xN array of bin start and stop indecies</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.set_edges">
<code class="descclassname">neurotools.signal.</code><code class="descname">set_edges</code><span class="sig-paren">(</span><em>edges</em>, <em>N</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#set_edges"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.set_edges" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts list of start, stop times over time period N into a [0,1]
array which is 1 for any time between a [start,stop)
edge info outsize [0,N] results in undefined behavior</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.remove_gaps">
<code class="descclassname">neurotools.signal.</code><code class="descname">remove_gaps</code><span class="sig-paren">(</span><em>w</em>, <em>cutoff</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#remove_gaps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.remove_gaps" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes gaps (streaches of zeros bordered by ones) from
binary signal <cite>w</cite> that are shorter than <cite>cutoff</cite> in duration.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>w</strong> (<em>one-dimensional array-like</em>) – Binary signal</li>
<li><strong>cutoff</strong> (<em>positive int</em>) – Minimum gap duration to keep</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Copy of w with gaps shorter than <cite>cutoff</cite> removed</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array-like</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.remove_short">
<code class="descclassname">neurotools.signal.</code><code class="descname">remove_short</code><span class="sig-paren">(</span><em>w</em>, <em>cutoff</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#remove_short"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.remove_short" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes spans of ones bordered by zeros from
binary signal <cite>w</cite> that are shorter than <cite>cutoff</cite> in duration.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>w</strong> (<em>one-dimensional array-like</em>) – Binary signal</li>
<li><strong>cutoff</strong> (<em>positive int</em>) – Minimum gap duration to keep</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Copy of w with spans shorter than <cite>cutoff</cite> removed</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array-like</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.phase_rotate">
<code class="descclassname">neurotools.signal.</code><code class="descname">phase_rotate</code><span class="sig-paren">(</span><em>s</em>, <em>f</em>, <em>Fs=1000.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#phase_rotate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.phase_rotate" title="Permalink to this definition">¶</a></dt>
<dd><p>Only the phase advancement portion of a resonator.
See resonantDrive</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.fm_mod">
<code class="descclassname">neurotools.signal.</code><code class="descname">fm_mod</code><span class="sig-paren">(</span><em>freq</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#fm_mod"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.fm_mod" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="neurotools.signal.pieces">
<code class="descclassname">neurotools.signal.</code><code class="descname">pieces</code><span class="sig-paren">(</span><em>x</em>, <em>thr=4</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#pieces"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.pieces" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="neurotools.signal.stats_block">
<code class="descclassname">neurotools.signal.</code><code class="descname">stats_block</code><span class="sig-paren">(</span><em>data</em>, <em>statfunction</em>, <em>N=100</em>, <em>sample_match=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#stats_block"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.stats_block" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute function of signal in blocks of size $N$ over the last axis
of the data</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<em>np.array</em>) – N-dimensional numpy array. Blocking is performed over the last axis</li>
<li><strong>statfunction</strong> (<em>function</em>) – Statistical function to compute on each block. Should be, or
behave similarly to, the <cite>numpy</cite> buit-ins, e.g. np.mean,
np.median, etc.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Other Parameters:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><ul class="first simple">
<li><strong>N</strong> (<em>positive integer, default 100</em>) – Block size in which to break data. If data cannot be split
evenly into blocks of size $N$, then data are truncated to the
largest integer multiple of N.</li>
<li><strong>sample_match</strong> (<em>positive integer, default None</em>) – If not None, then blocks will be sub-sampled to contain
<cite>sample_match</cite> samples. <cite>sample_match</cite> should not exceed
data.shape[-1]//N</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Blocked data</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">np.array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.mean_block">
<code class="descclassname">neurotools.signal.</code><code class="descname">mean_block</code><span class="sig-paren">(</span><em>data</em>, <em>N=100</em>, <em>sample_match=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#mean_block"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.mean_block" title="Permalink to this definition">¶</a></dt>
<dd><p>Calls stats_block using np.mean. See documentation of stats_block for
details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>stats_block documentation</strong> (<em>See</em>) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Block-averaged data</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">np.array</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.var_block">
<code class="descclassname">neurotools.signal.</code><code class="descname">var_block</code><span class="sig-paren">(</span><em>data</em>, <em>N=100</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#var_block"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.var_block" title="Permalink to this definition">¶</a></dt>
<dd><p>Calls stats_block using np.var. See documentation of stats_block for
details.</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.median_block">
<code class="descclassname">neurotools.signal.</code><code class="descname">median_block</code><span class="sig-paren">(</span><em>data</em>, <em>N=100</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#median_block"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.median_block" title="Permalink to this definition">¶</a></dt>
<dd><p>Calls stats_block using np.median. See documentation of stats_block for
details.</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.phase_randomize">
<code class="descclassname">neurotools.signal.</code><code class="descname">phase_randomize</code><span class="sig-paren">(</span><em>signal</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#phase_randomize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.phase_randomize" title="Permalink to this definition">¶</a></dt>
<dd><p>Phase randomizes a signal by rotating frequency components by a random
angle. Negative frequencies are rotated in the opposite direction.
The nyquist frequency, if present, has it’s sign randomly flipped.</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.phase_randomize_from_amplitudes">
<code class="descclassname">neurotools.signal.</code><code class="descname">phase_randomize_from_amplitudes</code><span class="sig-paren">(</span><em>amplitudes</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#phase_randomize_from_amplitudes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.phase_randomize_from_amplitudes" title="Permalink to this definition">¶</a></dt>
<dd><p>treats input amplitudes as amplitudes of fourier components</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.estimate_padding">
<code class="descclassname">neurotools.signal.</code><code class="descname">estimate_padding</code><span class="sig-paren">(</span><em>fa</em>, <em>fb</em>, <em>Fs=1000</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#estimate_padding"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.estimate_padding" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate the amount of padding needed to address boundary conditions
when filtering. Takes into account the filter bandwidth, which is
related to the time-locality of the filter, and therefore the amount
of padding needed to prevent artifacts at the edge.</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.lowpass_filter">
<code class="descclassname">neurotools.signal.</code><code class="descname">lowpass_filter</code><span class="sig-paren">(</span><em>x</em>, <em>cut=10</em>, <em>Fs=1000</em>, <em>order=4</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#lowpass_filter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.lowpass_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute a butterworth low pass Filter at frequency “cut”
Defaults to order=4 and Fs=1000</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.highpass_filter">
<code class="descclassname">neurotools.signal.</code><code class="descname">highpass_filter</code><span class="sig-paren">(</span><em>x</em>, <em>cut=40</em>, <em>Fs=1000</em>, <em>order=4</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#highpass_filter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.highpass_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute a butterworth high pass Filter at frequency “cut”
Defaults to order=4 and Fs=1000</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.fdiff">
<code class="descclassname">neurotools.signal.</code><code class="descname">fdiff</code><span class="sig-paren">(</span><em>x</em>, <em>Fs=240.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#fdiff"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.fdiff" title="Permalink to this definition">¶</a></dt>
<dd><p>Take the discrete derivative of a signal, correcting result for
sample rate. This procedure returns a singnal two samples shorter than
the original.</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.interpolate_NaN">
<code class="descclassname">neurotools.signal.</code><code class="descname">interpolate_NaN</code><span class="sig-paren">(</span><em>u</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#interpolate_NaN"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.interpolate_NaN" title="Permalink to this definition">¶</a></dt>
<dd><p>Fill in NaN (missing) data in a one-dimensional timeseries via linear
interpolation.</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.interpolate_NaN_quadratic">
<code class="descclassname">neurotools.signal.</code><code class="descname">interpolate_NaN_quadratic</code><span class="sig-paren">(</span><em>u</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#interpolate_NaN_quadratic"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.interpolate_NaN_quadratic" title="Permalink to this definition">¶</a></dt>
<dd><p>Fill in NaN (missing) data in a one-dimensional timeseries via quadratic
interpolation.</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.killSpikes">
<code class="descclassname">neurotools.signal.</code><code class="descname">killSpikes</code><span class="sig-paren">(</span><em>x</em>, <em>threshold=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#killSpikes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.killSpikes" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove times when the signal exceeds a given threshold of the
standard deviation of the underlying signal. Removed data are
re-interpolated from the edges. This procedure is particularly
useful in correcting higkinematics velocity trajectories. Velocity
should be smooth, but motion tracking errors can cause sharp spikes
in the signal.</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.peak_within">
<code class="descclassname">neurotools.signal.</code><code class="descname">peak_within</code><span class="sig-paren">(</span><em>freqs</em>, <em>spectrum</em>, <em>fa</em>, <em>fb</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#peak_within"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.peak_within" title="Permalink to this definition">¶</a></dt>
<dd><p>Find maximum within a band</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>freqs</strong> (<em>np.array</em>) – Frequencies</li>
<li><strong>spectrum</strong> – </li>
<li><strong>fa</strong> (<em>float</em>) – low-frequency cutoff</li>
<li><strong>fb</strong> (<em>float</em>) – high-frequency cutoff</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.local_peak_within">
<code class="descclassname">neurotools.signal.</code><code class="descname">local_peak_within</code><span class="sig-paren">(</span><em>freqs</em>, <em>cc</em>, <em>fa</em>, <em>fb</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#local_peak_within"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.local_peak_within" title="Permalink to this definition">¶</a></dt>
<dd><p>For a spectrum, identify the largest local maximum in the frequency
range [fa,fb].</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>freqs</strong> (<em>np.array</em>) – Frequencies</li>
<li><strong>cc</strong> (<em>np.array</em>) – Amplitude</li>
<li><strong>fa</strong> (<em>float</em>) – low-frequency cutoff</li>
<li><strong>fb</strong> (<em>float</em>) – high-frequency cutoff</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><em>i</em> – index of peak, or None if no local peak found</li>
<li><em>frequency</em> – frequency at peak, or None if no local peak found</li>
<li><em>peak</em> – amplitude at peak, or None if no local peak found</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.zeromean">
<code class="descclassname">neurotools.signal.</code><code class="descname">zeromean</code><span class="sig-paren">(</span><em>x</em>, <em>axis=0</em>, <em>verbose=False</em>, <em>ignore_nan=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#zeromean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.zeromean" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove the mean trend from data</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<em>np.array</em>) – Data to remove mean trend from</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Other Parameters:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><strong>axis</strong> (<em>int or tuple, default None</em>) – Axis over which to take the mean;
forwarded to np.mean axis parameter</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.zscore">
<code class="descclassname">neurotools.signal.</code><code class="descname">zscore</code><span class="sig-paren">(</span><em>x</em>, <em>axis=0</em>, <em>regularization=1e-30</em>, <em>verbose=False</em>, <em>ignore_nan=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#zscore"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.zscore" title="Permalink to this definition">¶</a></dt>
<dd><p>Z-scores data, defaults to the first axis.
A regularization factor is added to the standard deviation to preven
numerical instability when the standard deviation is extremely small.
The default refularization is 1e-30.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> – Array-like real-valued signal.</li>
<li><strong>axis</strong> – Axis to zscore; default is 0.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>x</strong> – (x-mean(x))/std(x)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">np.ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.gaussianize">
<code class="descclassname">neurotools.signal.</code><code class="descname">gaussianize</code><span class="sig-paren">(</span><em>x</em>, <em>axis=-1</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#gaussianize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.gaussianize" title="Permalink to this definition">¶</a></dt>
<dd><p>Use percentiles to force a timeseries to have a normal distribution.</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.deltaovermean">
<code class="descclassname">neurotools.signal.</code><code class="descname">deltaovermean</code><span class="sig-paren">(</span><em>x</em>, <em>axis=0</em>, <em>regularization=1e-30</em>, <em>verbose=False</em>, <em>ignore_nan=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#deltaovermean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.deltaovermean" title="Permalink to this definition">¶</a></dt>
<dd><p>Subtracts, then divides by, the mean.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> – Array-like real-valued signal.</li>
<li><strong>axis</strong> – Axis to zscore; default is 0.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>x</strong> – (x-mean(x))/std(x)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">np.ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.unit_length">
<code class="descclassname">neurotools.signal.</code><code class="descname">unit_length</code><span class="sig-paren">(</span><em>x</em>, <em>axis=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#unit_length"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.unit_length" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpret given axis of multidimensional array as vectors,
and normalize them to unit length.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<em>np.array</em>) – </td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Other Parameters:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><strong>axis</strong> (<em>int or tuple, default None</em>)</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>u</strong> – vectors in <cite>x</cite> normalized to unit length</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">np.array</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.sign_preserving_amplitude_demodulate">
<code class="descclassname">neurotools.signal.</code><code class="descname">sign_preserving_amplitude_demodulate</code><span class="sig-paren">(</span><em>analytic_signal</em>, <em>doplot=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#sign_preserving_amplitude_demodulate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.sign_preserving_amplitude_demodulate" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts an amplitude-modulated component from an analytic signal,
Correctly flipping the sign of the signal when it crosses zero,
rather than returning a rectified result.</p>
<dl class="docutils">
<dt>Sign-changes are heuriddddstically detected basd on the following:</dt>
<dd><ul class="first last simple">
<li>An abnormally large skip in phase between two time points,
larger than np.pi/2, that is also a local extremum in phase velocity</li>
<li>local minima in the amplitude at low-voltage with high curvature</li>
</ul>
</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>analytic_signal</strong> – </td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Other Parameters:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><strong>doplot</strong> (<em>boolean, False</em>)</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">demodulated</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.autocorrelation">
<code class="descclassname">neurotools.signal.</code><code class="descname">autocorrelation</code><span class="sig-paren">(</span><em>x</em>, <em>lags=None</em>, <em>center=True</em>, <em>normalize=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#autocorrelation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.autocorrelation" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the normalized autocorrelation over the specified
time-lags using convolution. Autocorrelation is normalized
such that the zero-lag autocorrelation is 1.</p>
<p>TODO, fix: For long
lags it uses FFT, but has a different normalization from the
time-domain implementation for short lags. In practice this
will not matter.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>x</strong> (<em>1d array</em>) – Data for which to compute autocorrelation function</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Other Parameters:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><ul class="first simple">
<li><strong>lags</strong> (<em>int, default length of signal or 200, whichever is smaller</em>) – Number of time-lags over which to compute the ACF. Default
is min(200,len(x))</li>
<li><strong>center</strong> (<em>bool, default True</em>) – Whether to mean-center data before taking autocorrelation</li>
<li><strong>normalize</strong> (<em>bool, default True</em>) – Whether to normalize by zero-lag signal variance</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Autocorrelation function, length 2*lags + 1</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.upsample">
<code class="descclassname">neurotools.signal.</code><code class="descname">upsample</code><span class="sig-paren">(</span><em>x</em>, <em>factor=4</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#upsample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.upsample" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses fourier transform to upsample x by some factor.</p>
<p>Operations:</p>
<ol class="arabic simple">
<li>remove linear trend</li>
<li>mirror to get reflected boundary</li>
<li>take the fourier transform</li>
<li>add padding zeros to FFT to effectively upsample</li>
<li>taking inverse fourier transform</li>
<li>remove mirroring</li>
<li>restore linear tend</li>
</ol>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>factor</strong> (<em>int</em>) – Integer upsampling factor. Default is 4.</li>
<li><strong>x</strong> (<em>array-like</em>) – X is cast to float64 before processing. Complex values are
not supported.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>x</strong> – upsampled <cite>x</cite></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.linfilter">
<code class="descclassname">neurotools.signal.</code><code class="descname">linfilter</code><span class="sig-paren">(</span><em>A</em>, <em>C</em>, <em>x</em>, <em>initial=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#linfilter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.linfilter" title="Permalink to this definition">¶</a></dt>
<dd><p>Linear response filter on data $x$ for system</p>
<p>$$
partial_t z = A z + C x(t)
$$</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>A</strong> (<em>matrix</em>) – K x K matrix defining linear syste,</li>
<li><strong>C</strong> (<em>matrix</em>) – K x N matrix defining projection from signal $x$ to linear system</li>
<li><strong>x</strong> (<em>vector</em><em> or </em><em>matrix</em>) – T x N sequence of states to filter</li>
<li><strong>initial</strong> (<em>vector</em>) – Optional length N vector of initial filter conditions. Set to 0
by default</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>filtered</strong> – filtered data</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.span">
<code class="descclassname">neurotools.signal.</code><code class="descname">span</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#span"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.span" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the range of values (min,max) spanned by a dataset</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<em>array-like</em><em>, </em><em>numeric</em>) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">np.max(data)-np.min(data)</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">span</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.make_lagged">
<code class="descclassname">neurotools.signal.</code><code class="descname">make_lagged</code><span class="sig-paren">(</span><em>x</em>, <em>NLAGS=5</em>, <em>LAGSPACE=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#make_lagged"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.make_lagged" title="Permalink to this definition">¶</a></dt>
<dd><p>Create shifted/lagged copies of a 1D signal.
These are retrospective (causal) features.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>x</strong> (1D np.array length <cite>T</cite>) – </p>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Other Parameters:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><ul class="first simple">
<li><strong>NLAGS</strong> (<em>positive int; default 5</em>)</li>
<li><strong>LAGSPACE</strong> (<em>positive int; default 1</em>)</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>result</strong> – The first element is the original unshifted signal.
Later elements are shifts progressively further
back in time.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">NLAGS×T np.array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.zgrid">
<code class="descclassname">neurotools.signal.</code><code class="descname">zgrid</code><span class="sig-paren">(</span><em>L</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#zgrid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.zgrid" title="Permalink to this definition">¶</a></dt>
<dd><p>2D grid coordinates as complex numbers, ranging from -L/2 to L/2</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>L</strong> (<em>int</em>) – Desired size of LxL grid</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>np.complex64</strong></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">LxL coordinate grid; center is zero.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.nice_interp">
<code class="descclassname">neurotools.signal.</code><code class="descname">nice_interp</code><span class="sig-paren">(</span><em>a</em>, <em>b</em>, <em>t</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#nice_interp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.nice_interp" title="Permalink to this definition">¶</a></dt>
<dd><p>numpy.interp1d with nice defaults</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>a</strong> (<em>x values for interpolation</em>) – </li>
<li><strong>b</strong> (<em>y values for interpolation</em>) – </li>
<li><strong>t</strong> (<em>x values to sample at</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>np.array</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">interpolated values</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.fftacorr1d">
<code class="descclassname">neurotools.signal.</code><code class="descname">fftacorr1d</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#fftacorr1d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.fftacorr1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Autocorrelogram via FFT.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<em>bp.float32</em>) – </td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.fftsta">
<code class="descclassname">neurotools.signal.</code><code class="descname">fftsta</code><span class="sig-paren">(</span><em>spikes</em>, <em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#fftsta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.fftsta" title="Permalink to this definition">¶</a></dt>
<dd><p>Spike triggerd average (STA) via FFT
Signal <cite>x</cite> is z-scored befor calculating the spike-triggered average
(a.k.a. reverse correlation).
The returned STA is normalized so that the maximum magnitude is 1.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>spikes</strong> (<em>np.array</em>) – 1D spike count vector</li>
<li><strong>x</strong> (<em>np.array</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>np.float32</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">normalized spike-triggered average</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.interpmax1d">
<code class="descclassname">neurotools.signal.</code><code class="descname">interpmax1d</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#interpmax1d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.interpmax1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Locate a peak in a 1D array by interpolation; see
dspguru.com/dsp/howtos/how-to-interpolate-fft-peak</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<em>1D np.array; Signal in which to locate the gloabal maximum.</em>) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>i</strong></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">float; Interpolated index of global maximum in <cite>x</cite>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.spaced_derivative">
<code class="descclassname">neurotools.signal.</code><code class="descname">spaced_derivative</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#spaced_derivative"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.spaced_derivative" title="Permalink to this definition">¶</a></dt>
<dd><p>Differentiate a 1D timeseries returning a new vector with the same
number of samples. This smoothly interpolates between a forward
difference at the start of the signal and a backward difference at
the end of the signal.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<em>1D np.float32</em>) – Signal to differentiate</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.drop_nonfinite">
<code class="descclassname">neurotools.signal.</code><code class="descname">drop_nonfinite</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#drop_nonfinite"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.drop_nonfinite" title="Permalink to this definition">¶</a></dt>
<dd><p>Flatten array and remove non-finite values</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x</strong> (<em>np.float32</em>) – Numpy array from which to move non-finite values</li>
<li><strong>Returns</strong> – </li>
<li><strong>np.float32</strong> (<em>1D</em>) – Flattened array with non-finite values removed.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.split_into_groups">
<code class="descclassname">neurotools.signal.</code><code class="descname">split_into_groups</code><span class="sig-paren">(</span><em>x</em>, <em>group_sizes</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#split_into_groups"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.split_into_groups" title="Permalink to this definition">¶</a></dt>
<dd><p>Split <cite>np.array</cite> <cite>x</cite> into <cite>len(group_sizes)</cite> groups,
with the size of the groups specified by <cite>group_sizes</cite>.</p>
<p>This operates along the last axis of <cite>x</cite></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>np.array</em>) – Numpy array to split; Last axis should have the
same length as <cite>sum(group_sizes)</cite></li>
<li><strong>group_sizes</strong> (<em>iterable of positive ints</em>) – Group sizes</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">List of sub-arrays for each group</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.uniformize">
<code class="descclassname">neurotools.signal.</code><code class="descname">uniformize</code><span class="sig-paren">(</span><em>x</em>, <em>axis=-1</em>, <em>killeps=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#uniformize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.uniformize" title="Permalink to this definition">¶</a></dt>
<dd><p>Use percentiles to force a timeseries to have a uniform
[0,1] distribution.</p>
<p><cite>uniformize()</cite> was designed to operate on non-negative
data and  has some quirks that have been retained for
archiving and backwards compatibility.</p>
<p>Namely, if the <cite>killeps</cite> argument is provided,
<cite>uniformize()</cite> assumes that inputs are non-
negative and excludes values less than <cite>killeps`*σ,
where σ is the standard-deviation of `x</cite>, from the
percentile rankings. The original default for
<cite>killeps</cite> was <cite>1e-3</cite>.</p>
<p>This was done because in the T-maze experiments,
the mouse often spends quite a bit of time at the
beginning of the maze. We don’t want most of the [0,1]
dynamic range dedicatde to encoding positions or times
near the start of trials. So, we estimate the scale
of <cite>x</cite> using its standard deviation, and then clip
values that are small relative to this scale.
This heuristic works for position/time data from the
Dan-Helen-Ethan experiments, but isn’t very general.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>x</strong> (<em>np.float32:</em>) – Timeseries</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Other Parameters:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><ul class="first last simple">
<li><strong>axis</strong> (<em>axis specifies; default -1</em>) – axis argument forwarded to ` scipy.stats.rankdata`</li>
<li><strong>killeps</strong> (<em>positive float; default None</em>) – Original value of <cite>killeps</cite> passed to
<cite>uniformize()</cite></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.invert_uniformize">
<code class="descclassname">neurotools.signal.</code><code class="descname">invert_uniformize</code><span class="sig-paren">(</span><em>x</em>, <em>p</em>, <em>axis=-1</em>, <em>killeps=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#invert_uniformize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.invert_uniformize" title="Permalink to this definition">¶</a></dt>
<dd><p>Inverts the <cite>uniformize()</cite> function</p>
<p><cite>uniformize()</cite> was designed to operate on non-negative
data and has some quirks that have been retained for
archiving and backwards compatibility.</p>
<p>Namely, if the <cite>killeps</cite> argument is provided,
<cite>uniformize()</cite> assumes that inputs are non-
negative and excludes values less than <cite>killeps`*σ,
where σ is the standard-deviation of `x</cite>, from the
percentile rankings. The original default for
<cite>killeps</cite> was <cite>1e-3</cite>.</p>
<p>This was done because in the T-maze experiments,
the mouse often spends quite a bit of time at the
beginning of the maze. We don’t want most of the [0,1]
dynamic range dedicate to encoding positions or times
near the start of trials. So, we estimate the scale
of <cite>x</cite> using its standard deviation, and then clip
values that are small relative to this scale.
This heuristic works for position/time data from the
Dan-Helen-Ethan experiments, but isn’t very general.</p>
<p>Uniformize processing steps</p>
<blockquote>
<div><ul class="simple">
<li>Mark timepoints where abs(x)&lt;killeps*std(x)</li>
<li>Rank data excluding these timepoints</li>
<li>Check how many timepoints were actually included</li>
<li>Normalize ranks to this amount</li>
</ul>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>np.float32:</em>) – Original timeseries passed as argument <cite>x</cite> to
<cite>uinformize()</cite></li>
<li><strong>p</strong> (<em>np.float32 ∈</em><em> [</em><em>0</em><em>,</em><em>1</em><em>]</em>) – Values on [0,1] interval to convert back into
raw signal values, based on percentiles of
<cite>x</cite>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Other Parameters:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><ul class="first simple">
<li><strong>axis</strong> (<em>axis specifies; default -1</em>) – axis argument forwarded to ` scipy.stats.rankdata`</li>
<li><strong>killeps</strong> (<em>positive float; default None</em>) – Original value of <cite>killeps</cite> passed to
<cite>uniformize()</cite> (leave blank if you did not specify
this argument; It defaults to 1e-3)</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Recontructed values.
This should be equivalent to the original data
with values less than <cite>killeps</cite> times the
standard-deviation “σ” of <cite>original_x</cite> set to
σ*killeps</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">np.float32</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.virtual_reference_line_noise_removal">
<code class="descclassname">neurotools.signal.</code><code class="descname">virtual_reference_line_noise_removal</code><span class="sig-paren">(</span><em>lfps</em>, <em>frequency=60</em>, <em>hbw=5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#virtual_reference_line_noise_removal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.virtual_reference_line_noise_removal" title="Permalink to this definition">¶</a></dt>
<dd><p>Accepts an array of LFP recordings (first dimension should be
channel number, second dimension time ).
Sample rate assumed 1000Hz</p>
<p>Extracts the mean signal within 2.5 Hz of 60Hz.
For each channel, removes the projection of the LFP signal onto this
estimated line noise signal.</p>
<p>To also want to filter out overtones,
see <cite>band_stop_line_noise_removal()</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>lfps</strong> – LFP channel data</li>
<li><strong>frequency</strong> (<em>positive number</em>) – Line noise frequency, defaults to 60 Hz
(USA).</li>
<li><strong>hbw</strong> (<em>positive number</em>) – Half-bandwidth settings; Default is 5</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>removed</strong> – Band-stop filtered signal</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">np.array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.band_stop_line_noise_removal">
<code class="descclassname">neurotools.signal.</code><code class="descname">band_stop_line_noise_removal</code><span class="sig-paren">(</span><em>lfps</em>, <em>frequency=60.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal.html#band_stop_line_noise_removal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.band_stop_line_noise_removal" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove line noise using band-stop at 60Hz
and overtones.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>lfps</strong> – LFP channel data</li>
<li><strong>frequency</strong> (<em>positive number</em>) – Line noise frequency, defaults to 60 Hz
(USA).</li>
<li><strong>hbw</strong> (<em>positive number</em>) – Half-bandwidth settings; Default is 10</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>removed</strong> – Band-stop filtered signal</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">np.array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Neurotools" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="neurotools.signal.coherence.html" class="btn btn-neutral float-right" title="neurotools.signal.coherence module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2017, M Rule.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>