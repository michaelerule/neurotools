

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>neurotools.signal.ppc module &mdash; Neurotools 2 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="neurotools.signal.resonator module" href="neurotools.signal.resonator.html" />
    <link rel="prev" title="neurotools.signal.multitaper module" href="neurotools.signal.multitaper.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Neurotools
          

          
          </a>

          
            
            
              <div class="version">
                2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">neurotools</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="neurotools.html">neurotools package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="neurotools.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="neurotools.encoding.html">neurotools.encoding package</a></li>
<li class="toctree-l4"><a class="reference internal" href="neurotools.gpu.html">neurotools.gpu package</a></li>
<li class="toctree-l4"><a class="reference internal" href="neurotools.graphics.html">neurotools.graphics package</a></li>
<li class="toctree-l4"><a class="reference internal" href="neurotools.jobs.html">neurotools.jobs package</a></li>
<li class="toctree-l4"><a class="reference internal" href="neurotools.linalg.html">neurotools.linalg package</a></li>
<li class="toctree-l4"><a class="reference internal" href="neurotools.models.html">neurotools.models package</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="neurotools.signal.html">neurotools.signal package</a><ul class="current">
<li class="toctree-l5 current"><a class="reference internal" href="neurotools.signal.html#submodules">Submodules</a></li>
<li class="toctree-l5"><a class="reference internal" href="neurotools.signal.html#module-neurotools.signal">Module contents</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="neurotools.spatial.html">neurotools.spatial package</a></li>
<li class="toctree-l4"><a class="reference internal" href="neurotools.spikes.html">neurotools.spikes package</a></li>
<li class="toctree-l4"><a class="reference internal" href="neurotools.stats.html">neurotools.stats package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="neurotools.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="neurotools.html#module-neurotools">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Neurotools</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="modules.html">neurotools</a> &raquo;</li>
        
          <li><a href="neurotools.html">neurotools package</a> &raquo;</li>
        
          <li><a href="neurotools.signal.html">neurotools.signal package</a> &raquo;</li>
        
      <li>neurotools.signal.ppc module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/neurotools.signal.ppc.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-neurotools.signal.ppc">
<span id="neurotools-signal-ppc-module"></span><h1>neurotools.signal.ppc module<a class="headerlink" href="#module-neurotools.signal.ppc" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="neurotools.signal.ppc.phase_randomize_complex">
<code class="descclassname">neurotools.signal.ppc.</code><code class="descname">phase_randomize_complex</code><span class="sig-paren">(</span><em>signal</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/ppc.html#phase_randomize_complex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.ppc.phase_randomize_complex" title="Permalink to this definition">¶</a></dt>
<dd><p>Phase randomizes a signal by rotating frequency components by a random
angle. Negative frequencies are rotated in the opposite direction.
The nyquist frequency, if present, has it’s sign randomly flipped.</p>
<p>Returns complex-valued array.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>signal</strong> (<em>1D array</em>) – </td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.ppc.phase_randomize">
<code class="descclassname">neurotools.signal.ppc.</code><code class="descname">phase_randomize</code><span class="sig-paren">(</span><em>signal</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/ppc.html#phase_randomize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.ppc.phase_randomize" title="Permalink to this definition">¶</a></dt>
<dd><p>Phase randomizes a signal by rotating frequency components by a random
angle. Negative frequencies are rotated in the opposite direction.
The nyquist frequency, if present, has it’s sign randomly flipped.</p>
<p>Casts final result to a real-valued array.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>signal</strong> (<em>1D array</em>) – </td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.ppc.fftppc_biased">
<code class="descclassname">neurotools.signal.ppc.</code><code class="descname">fftppc_biased</code><span class="sig-paren">(</span><em>snippits</em>, <em>Fs=1000</em>, <em>taper=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/ppc.html#fftppc_biased"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.ppc.fftppc_biased" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>freqs: npp.array</dt>
<dd>Frequencies at which the PPC has been evaluated</dd>
<dt>raw: np.array</dt>
<dd>Raw (biased) value for the PPC at each frequency</dd>
<dt>phases: np.array</dt>
<dd>Phase values associated with each ppc coefficient</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.ppc.fftppc">
<code class="descclassname">neurotools.signal.ppc.</code><code class="descname">fftppc</code><span class="sig-paren">(</span><em>snippits</em>, <em>Fs=1000</em>, <em>taper=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/ppc.html#fftppc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.ppc.fftppc" title="Permalink to this definition">¶</a></dt>
<dd><p>make sure this is equivalent to the following matlab lines
raw     = abs(sum(S./abs(S))).^2;
ppc     = (raw - M)./(M.*(M-1));</p>
<p>the raw computation uses the mean which includes a 1/M factor
which is then squared so the raw PPC is already /M^2 compared
to the PPC value intermediate in the matlab code. So we have to
multiply it by M^2</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.ppc.fftppc_biased_multitaper">
<code class="descclassname">neurotools.signal.ppc.</code><code class="descname">fftppc_biased_multitaper</code><span class="sig-paren">(</span><em>snippits</em>, <em>Fs=1000</em>, <em>k=4</em>, <em>transpose_warning=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/ppc.html#fftppc_biased_multitaper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.ppc.fftppc_biased_multitaper" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>snippits</strong> (<em>Nspikes x Nwindow</em>) – Array of spike-triggered samples of the signal trace</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Other Parameters:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><ul class="first last simple">
<li><strong>Fs</strong> (<em>scalar</em>) – Sampling frequency. Defaults to 1000 Hz</li>
<li><strong>k</strong> (<em>positive integer</em>) – Number of tapers. Defaults to 4.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.ppc.fftppc_multitaper">
<code class="descclassname">neurotools.signal.ppc.</code><code class="descname">fftppc_multitaper</code><span class="sig-paren">(</span><em>snippits</em>, <em>Fs=1000</em>, <em>k=4</em>, <em>transpose_warning=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/ppc.html#fftppc_multitaper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.ppc.fftppc_multitaper" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="neurotools.signal.ppc.nodc">
<code class="descclassname">neurotools.signal.ppc.</code><code class="descname">nodc</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/ppc.html#nodc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.ppc.nodc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="neurotools.signal.ppc.discard_spikes_closer_than_delta">
<code class="descclassname">neurotools.signal.ppc.</code><code class="descname">discard_spikes_closer_than_delta</code><span class="sig-paren">(</span><em>signal</em>, <em>times</em>, <em>delta</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/ppc.html#discard_spikes_closer_than_delta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.ppc.discard_spikes_closer_than_delta" title="Permalink to this definition">¶</a></dt>
<dd><p>When computing PPC, we need to throw out spikes that are too close
together. This is a heuristic to make the spiking samples
“more independent”. We also need to skip spikes that are so close to
the edge of our data that we can’t get the LFP window surrounding
the spike time. Because certain tests that compare across conditions
require matching the number of spikes, to ensure that the variance
of the PPC estimator is comparable between the conditions, we expose
the code for selecting the subset of spikes for PPC here, so that
it can be used to ensure that both conditions have a matching number
of spikes</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.ppc.pairwise_phase_consistancy">
<code class="descclassname">neurotools.signal.ppc.</code><code class="descname">pairwise_phase_consistancy</code><span class="sig-paren">(</span><em>signal</em>, <em>times</em>, <em>window=50</em>, <em>Fs=1000</em>, <em>k=4</em>, <em>multitaper=True</em>, <em>biased=False</em>, <em>delta=100</em>, <em>taper=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/ppc.html#pairwise_phase_consistancy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.ppc.pairwise_phase_consistancy" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>signal</strong> (<em>1D real valued signal</em>) – </li>
<li><strong>times</strong> (<em>Times of events relative to signal</em>) – </li>
<li><strong>window</strong> (<em>Time around event to examine</em>) – </li>
<li><strong>Fs</strong> (<em>sample rate for computing freqs</em>) – </li>
<li><strong>k</strong> (<em>number of tapers</em>) – Also accepts lists of signals / times
returns (freqs, ppc, phase), lfp_segments</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.ppc.estimate_bias_in_uncorrected_ppc">
<code class="descclassname">neurotools.signal.ppc.</code><code class="descname">estimate_bias_in_uncorrected_ppc</code><span class="sig-paren">(</span><em>signal</em>, <em>times</em>, <em>window=50</em>, <em>Fs=1000</em>, <em>nrand=100</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/ppc.html#estimate_bias_in_uncorrected_ppc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.ppc.estimate_bias_in_uncorrected_ppc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="neurotools.signal.ppc.phase_randomized_bias_correction">
<code class="descclassname">neurotools.signal.ppc.</code><code class="descname">phase_randomized_bias_correction</code><span class="sig-paren">(</span><em>signal</em>, <em>times</em>, <em>window=50</em>, <em>Fs=1000</em>, <em>nrand=100</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/ppc.html#phase_randomized_bias_correction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.ppc.phase_randomized_bias_correction" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimates degrees of freedom using phase randomization.
experimental.</p>
<p>algebra could be dramaticalyl simplified, but keeping all explicit
for clarity for now</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.ppc.temp_code_for_exploring_chance_level_delete_later">
<code class="descclassname">neurotools.signal.ppc.</code><code class="descname">temp_code_for_exploring_chance_level_delete_later</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/ppc.html#temp_code_for_exploring_chance_level_delete_later"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.ppc.temp_code_for_exploring_chance_level_delete_later" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="neurotools.signal.ppc.ppc_chance_level">
<code class="descclassname">neurotools.signal.ppc.</code><code class="descname">ppc_chance_level</code><span class="sig-paren">(</span><em>nSamples</em>, <em>nrandom</em>, <em>p</em>, <em>nTapers=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/ppc.html#ppc_chance_level"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.ppc.ppc_chance_level" title="Permalink to this definition">¶</a></dt>
<dd><p>Don’t use this, it underestimates chance level in the presence of
Spike trian or LFP autocorrelations</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.ppc.ppc_phase_randomize_chance_level_sample">
<code class="descclassname">neurotools.signal.ppc.</code><code class="descname">ppc_phase_randomize_chance_level_sample</code><span class="sig-paren">(</span><em>signal</em>, <em>times</em>, <em>window=50</em>, <em>Fs=1000</em>, <em>k=4</em>, <em>multitaper=True</em>, <em>biased=False</em>, <em>delta=100</em>, <em>taper=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/ppc.html#ppc_phase_randomize_chance_level_sample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.ppc.ppc_phase_randomize_chance_level_sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses phase randomization to sample from the null hypothesis distribution.
Returns the actual PPC samples rather than any summary statistics.
You can do what you want with the distribution returned.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>signal</strong> (<em>1D real valued signal</em>) – </li>
<li><strong>times</strong> (<em>Times of events relative to signal</em>) – </li>
<li><strong>window</strong> (<em>Time around event to examine</em>) – </li>
<li><strong>Fs</strong> (<em>sample rate for computing freqs</em>) – </li>
<li><strong>k</strong> (<em>number of tapers</em>) – </li>
<li><strong>accepts lists of signals / times</strong> (<em>Also</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="neurotools.signal.resonator.html" class="btn btn-neutral float-right" title="neurotools.signal.resonator module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="neurotools.signal.multitaper.html" class="btn btn-neutral float-left" title="neurotools.signal.multitaper module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, M Rule

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>