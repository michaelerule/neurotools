

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>neurotools.signal.signal (Michael Rule’s conflicted copy 2017-08-11) module &mdash; Neurotools 2 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Neurotools 2 documentation" href="index.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="index.html" class="fa fa-home"> Neurotools</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="simple">
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Neurotools</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>neurotools.signal.signal (Michael Rule&#8217;s conflicted copy 2017-08-11) module</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="_sources/neurotools.signal.signal (Michael Rule&#39;s conflicted copy 2017-08-11).txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="neurotools-signal-signal-michael-rule-s-conflicted-copy-2017-08-11-module">
<h1>neurotools.signal.signal (Michael Rule&#8217;s conflicted copy 2017-08-11) module<a class="headerlink" href="#neurotools-signal-signal-michael-rule-s-conflicted-copy-2017-08-11-module" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="neurotools.signal.signal.amp">
<code class="descclassname">neurotools.signal.signal.</code><code class="descname">amp</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/signal.html#amp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.signal.amp" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts amplitude envelope using Hilbert transform. X must be narrow
band. No padding is performed so watch out for boundary effects</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.signal.ang">
<code class="descclassname">neurotools.signal.signal.</code><code class="descname">ang</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/signal.html#ang"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.signal.ang" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses the Hilbert transform to extract the phase of x. X should be
narrow-band. The signal is not padded, so be wary of boundary effects.</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.signal.arenear">
<code class="descclassname">neurotools.signal.signal.</code><code class="descname">arenear</code><span class="sig-paren">(</span><em>b</em>, <em>K=5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/signal.html#arenear"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.signal.arenear" title="Permalink to this definition">¶</a></dt>
<dd><p>Expand a boolean/binary sequence by K samples in each direction.
See &#8220;aresafe&#8221;</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.signal.aresafe">
<code class="descclassname">neurotools.signal.signal.</code><code class="descname">aresafe</code><span class="sig-paren">(</span><em>b</em>, <em>K=5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/signal.html#aresafe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.signal.aresafe" title="Permalink to this definition">¶</a></dt>
<dd><p>Contract a boolean/binary sequence by K samples in each direction.
For example, you may want to test for a condition, but avoid samples
close to edges in that condition.</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.signal.autocorrelation">
<code class="descclassname">neurotools.signal.signal.</code><code class="descname">autocorrelation</code><span class="sig-paren">(</span><em>x</em>, <em>lags=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/signal.html#autocorrelation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.signal.autocorrelation" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the normalized autocorrelation over the specified
time-lags using convolution. Autocorrelation is normalized
such that the zero-lag autocorrelation is 1.</p>
<p>This was written in haste and needs some work. For long
lags it uses FFT, but has a different normalization from the
time-domain implementation for short lags. In practice this
will not matter, but formally it&#8217;s good to be rigorous.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>1d array</em>) &#8211; Data for which to compute autocorrelation function</li>
<li><strong>lags</strong> (<em>int</em>) &#8211; Number of time-lags over which to compute the ACF. Default
is min(200,len(x))</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Autocorrelation function, length 2*lags + 1</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.signal.bandfilter">
<code class="descclassname">neurotools.signal.signal.</code><code class="descname">bandfilter</code><span class="sig-paren">(</span><em>data</em>, <em>fa=None</em>, <em>fb=None</em>, <em>Fs=1000.0</em>, <em>order=4</em>, <em>zerophase=True</em>, <em>bandstop=False</em><span class="sig-paren">)</span><a class="headerlink" href="#neurotools.signal.signal.bandfilter" title="Permalink to this definition">¶</a></dt>
<dd><p>IF fa is None, assumes lowpass with cutoff fb
IF fb is None, assume highpass with cutoff fa
Array can be any dimension, filtering performed over last dimension</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>data</strong> (<em>ndarray</em>) &#8211; data, filtering performed over last dimension</li>
<li><strong>fa</strong> (<em>number</em>) &#8211; low-frequency cutoff. If none, highpass at fb</li>
<li><strong>fb</strong> (<em>number</em>) &#8211; high-frequency cutoff. If none, lowpass at fa</li>
<li><strong>order</strong> (<em>1..6</em>) &#8211; butterworth filter order. Default 4</li>
<li><strong>zerophase</strong> (<em>boolean</em>) &#8211; Use forward-backward filtering? (true)</li>
<li><strong>bandstop</strong> (<em>boolean</em>) &#8211; Do band-stop rather than band-pass</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.signal.bandpass_filter">
<code class="descclassname">neurotools.signal.signal.</code><code class="descname">bandpass_filter</code><span class="sig-paren">(</span><em>data</em>, <em>fa=None</em>, <em>fb=None</em>, <em>Fs=1000.0</em>, <em>order=4</em>, <em>zerophase=True</em>, <em>bandstop=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/signal.html#bandpass_filter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.signal.bandpass_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>IF fa is None, assumes lowpass with cutoff fb
IF fb is None, assume highpass with cutoff fa
Array can be any dimension, filtering performed over last dimension</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>data</strong> (<em>ndarray</em>) &#8211; data, filtering performed over last dimension</li>
<li><strong>fa</strong> (<em>number</em>) &#8211; low-frequency cutoff. If none, highpass at fb</li>
<li><strong>fb</strong> (<em>number</em>) &#8211; high-frequency cutoff. If none, lowpass at fa</li>
<li><strong>order</strong> (<em>1..6</em>) &#8211; butterworth filter order. Default 4</li>
<li><strong>zerophase</strong> (<em>boolean</em>) &#8211; Use forward-backward filtering? (true)</li>
<li><strong>bandstop</strong> (<em>boolean</em>) &#8211; Do band-stop rather than band-pass</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.signal.box_filter">
<code class="descclassname">neurotools.signal.signal.</code><code class="descname">box_filter</code><span class="sig-paren">(</span><em>data</em>, <em>smoothat</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/signal.html#box_filter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.signal.box_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Smooths data by convolving with a size smoothat box
provide smoothat in units of frames i.e. samples (not ms or seconds)</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.signal.estimate_padding">
<code class="descclassname">neurotools.signal.signal.</code><code class="descname">estimate_padding</code><span class="sig-paren">(</span><em>fa</em>, <em>fb</em>, <em>Fs=1000</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/signal.html#estimate_padding"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.signal.estimate_padding" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate the amount of padding needed to address boundary conditions
when filtering. Takes into account the filter bandwidth, which is
related to the time-locality of the filter, and therefore the amount
of padding needed to prevent artifacts at the edge.</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.signal.fdiff">
<code class="descclassname">neurotools.signal.signal.</code><code class="descname">fdiff</code><span class="sig-paren">(</span><em>x</em>, <em>Fs=240.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/signal.html#fdiff"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.signal.fdiff" title="Permalink to this definition">¶</a></dt>
<dd><p>Take the discrete derivative of a signal, correcting result for
sample rate. This procedure returns a singnal two samples shorter than
the original.</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.signal.fm_mod">
<code class="descclassname">neurotools.signal.signal.</code><code class="descname">fm_mod</code><span class="sig-paren">(</span><em>freq</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/signal.html#fm_mod"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.signal.fm_mod" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="neurotools.signal.signal.fudge_derivative">
<code class="descclassname">neurotools.signal.signal.</code><code class="descname">fudge_derivative</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/signal.html#fudge_derivative"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.signal.fudge_derivative" title="Permalink to this definition">¶</a></dt>
<dd><p>Discretely differentiating a signal reduces its signal by one sample.
In some cases, this may be undesirable. It also creates ambiguity as
the sample times of the differentiated signal occur halfway between the
sample times of the original signal. This procedure uses averaging to
move the sample times of a differentiated signal back in line with the
original.</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.signal.gaussian_kernel">
<code class="descclassname">neurotools.signal.signal.</code><code class="descname">gaussian_kernel</code><span class="sig-paren">(</span><em>sigma</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/signal.html#gaussian_kernel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.signal.gaussian_kernel" title="Permalink to this definition">¶</a></dt>
<dd><p>generate 1D Guassian kernel for smoothing
sigma: standard deviation, &gt;0</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.signal.gaussian_smooth">
<code class="descclassname">neurotools.signal.signal.</code><code class="descname">gaussian_smooth</code><span class="sig-paren">(</span><em>x</em>, <em>sigma</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/signal.html#gaussian_smooth"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.signal.gaussian_smooth" title="Permalink to this definition">¶</a></dt>
<dd><p>Smooth signal x with gaussian of standard deviation sigma</p>
<p>sigma: standard deviation
x: 1D array-like signal</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.signal.get_edges">
<code class="descclassname">neurotools.signal.signal.</code><code class="descname">get_edges</code><span class="sig-paren">(</span><em>signal</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/signal.html#get_edges"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.signal.get_edges" title="Permalink to this definition">¶</a></dt>
<dd><p>Assuming a binary signal, get the start and stop times of each
treatch of &#8220;1s&#8221;</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.signal.getsnips">
<code class="descclassname">neurotools.signal.signal.</code><code class="descname">getsnips</code><span class="sig-paren">(</span><em>signal</em>, <em>times</em>, <em>window</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/signal.html#getsnips"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.signal.getsnips" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract snippits of a time series surronding a list of times. Typically
used for spike-triggered statistics</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.signal.gettriggeredstats">
<code class="descclassname">neurotools.signal.signal.</code><code class="descname">gettriggeredstats</code><span class="sig-paren">(</span><em>signal</em>, <em>times</em>, <em>window</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/signal.html#gettriggeredstats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.signal.gettriggeredstats" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a statistical summary of data in length window around time point
times.</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.signal.highpassFilter">
<code class="descclassname">neurotools.signal.signal.</code><code class="descname">highpassFilter</code><span class="sig-paren">(</span><em>x</em>, <em>cut=40</em>, <em>Fs=1000</em>, <em>order=4</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/signal.html#highpassFilter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.signal.highpassFilter" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute a butterworth high pass Filter at frequency &#8220;cut&#8221;
Defaults to order=4 and Fs=1000</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.signal.ifreq">
<code class="descclassname">neurotools.signal.signal.</code><code class="descname">ifreq</code><span class="sig-paren">(</span><em>x</em>, <em>Fs=1000</em>, <em>mode=u'pad'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/signal.html#ifreq"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.signal.ifreq" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract the instantaneous frequency from a narrow-band signal using
the Hilbert transform.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Fs</strong> (<em>int</em>) &#8211; defaults to 1000</li>
<li><strong>mode</strong> (<em>str</em>) &#8211; &#8216;pad&#8217; will return a signal of the original length
&#8216;valid&#8217; will return a signal 1 sample shorter, with derivative
computed between each pair od points in the original signal.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.signal.killSpikes">
<code class="descclassname">neurotools.signal.signal.</code><code class="descname">killSpikes</code><span class="sig-paren">(</span><em>x</em>, <em>threshold=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/signal.html#killSpikes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.signal.killSpikes" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove times when the signal exceeds a given threshold of the
standard deviation of the underlying signal. Removed data are
re-interpolated from the edges. This procedure is particularly
useful in correcting kinematics velocity trajectories. Velocity
should be smooth, but motion tracking errors can cause sharp spikes
in the signal.</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.signal.local_maxima">
<code class="descclassname">neurotools.signal.signal.</code><code class="descname">local_maxima</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/signal.html#local_maxima"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.signal.local_maxima" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns signal index and values at those indecies</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.signal.local_minima">
<code class="descclassname">neurotools.signal.signal.</code><code class="descname">local_minima</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/signal.html#local_minima"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.signal.local_minima" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns signal index and values at those indecies for all local minima.
See local_maxima</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.signal.local_peak_within">
<code class="descclassname">neurotools.signal.signal.</code><code class="descname">local_peak_within</code><span class="sig-paren">(</span><em>freqs</em>, <em>cc</em>, <em>fa</em>, <em>fb</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/signal.html#local_peak_within"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.signal.local_peak_within" title="Permalink to this definition">¶</a></dt>
<dd><p>For a spectrum, identify the largest local maximum in the frequency
range [fa,fb].</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.signal.lowpass_filter">
<code class="descclassname">neurotools.signal.signal.</code><code class="descname">lowpass_filter</code><span class="sig-paren">(</span><em>x</em>, <em>cut=10</em>, <em>Fs=1000</em>, <em>order=4</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/signal.html#lowpass_filter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.signal.lowpass_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute a butterworth low pass Filter at frequency &#8220;cut&#8221;
Defaults to order=4 and Fs=1000</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.signal.mean_block">
<code class="descclassname">neurotools.signal.signal.</code><code class="descname">mean_block</code><span class="sig-paren">(</span><em>data</em>, <em>N=100</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/signal.html#mean_block"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.signal.mean_block" title="Permalink to this definition">¶</a></dt>
<dd><p>blocks data by mean over last axis</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.signal.median_block">
<code class="descclassname">neurotools.signal.signal.</code><code class="descname">median_block</code><span class="sig-paren">(</span><em>data</em>, <em>N=100</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/signal.html#median_block"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.signal.median_block" title="Permalink to this definition">¶</a></dt>
<dd><p>blocks data by median over last axis</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.signal.median_filter">
<code class="descclassname">neurotools.signal.signal.</code><code class="descname">median_filter</code><span class="sig-paren">(</span><em>x</em>, <em>window=100</em>, <em>mode='same'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/signal.html#median_filter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.signal.median_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Filters a signal by calculating the median in a sliding window of
width &#8216;window&#8217;</p>
<dl class="docutils">
<dt>mode=&#8217;same&#8217; will compute median even at the edges, where a full window</dt>
<dd>is not available</dd>
<dt>mode=&#8217;valid&#8217; will compute median only at points where the full window</dt>
<dd>is available</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.signal.nonnegative_bandpass_filter">
<code class="descclassname">neurotools.signal.signal.</code><code class="descname">nonnegative_bandpass_filter</code><span class="sig-paren">(</span><em>data</em>, <em>fa=None</em>, <em>fb=None</em>, <em>Fs=1000.0</em>, <em>order=4</em>, <em>zerophase=True</em>, <em>bandstop=False</em>, <em>offset=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/signal.html#nonnegative_bandpass_filter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.signal.nonnegative_bandpass_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>For filtering data that must remain non-negative. Due to ringing
conventional fitering can create values less than zero for non-
negative real inputs. This may be unrealistic for some data.</p>
<p>To compensate, this performs the filtering on the natural
logarithm of the input data. For small numbers, this can lead to
numeric underflow, so an offset parameter (default 1) is added
to the data for stability.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>data</strong> (<em>ndarray</em>) &#8211; data, filtering performed over last dimension</li>
<li><strong>fa</strong> (<em>number</em>) &#8211; low-freq cutoff Hz. If none, lowpass at fb</li>
<li><strong>fb</strong> (<em>number</em>) &#8211; high-freq cutoff Hz. If none, highpass at fa</li>
<li><strong>Fs</strong> (<em>int</em>) &#8211; Sample rate in Hz</li>
<li><strong>order</strong> (<em>1..6</em>) &#8211; butterworth filter order. Default 4</li>
<li><strong>zerophase</strong> (<em>boolean</em>) &#8211; Use forward-backward filtering? (true)</li>
<li><strong>bandstop</strong> (<em>boolean</em>) &#8211; Do band-stop rather than band-pass</li>
<li><strong>offset</strong> (<em>positive number</em>) &#8211; Offset data to avoid underflow (1)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.signal.padin">
<code class="descclassname">neurotools.signal.signal.</code><code class="descname">padin</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/signal.html#padin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.signal.padin" title="Permalink to this definition">¶</a></dt>
<dd><p>See padout</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.signal.padout">
<code class="descclassname">neurotools.signal.signal.</code><code class="descname">padout</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/signal.html#padout"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.signal.padout" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a reflected version of a 1-dimensional signal. This can be
handy for achieving reflected boundary conditions in algorithms that
do not support this condition by default.</p>
<p>The original data is placed in the middle, between the mirrord copies.
Use the function &#8220;padin&#8221; to strip the padding</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.signal.pdiff">
<code class="descclassname">neurotools.signal.signal.</code><code class="descname">pdiff</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/signal.html#pdiff"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.signal.pdiff" title="Permalink to this definition">¶</a></dt>
<dd><p>Take the derivative of a sequence of phases.
Times when this derivative wraps around form 0 to 2*pi are correctly
handeled.</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.signal.peak_within">
<code class="descclassname">neurotools.signal.signal.</code><code class="descname">peak_within</code><span class="sig-paren">(</span><em>freqs</em>, <em>spectrum</em>, <em>fa</em>, <em>fb</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/signal.html#peak_within"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.signal.peak_within" title="Permalink to this definition">¶</a></dt>
<dd><p>Find maximum within a band</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.signal.pghilbert">
<code class="descclassname">neurotools.signal.signal.</code><code class="descname">pghilbert</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/signal.html#pghilbert"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.signal.pghilbert" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract phase gradient using the hilbert transform. See also pdiff.</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.signal.phase_randomize">
<code class="descclassname">neurotools.signal.signal.</code><code class="descname">phase_randomize</code><span class="sig-paren">(</span><em>signal</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/signal.html#phase_randomize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.signal.phase_randomize" title="Permalink to this definition">¶</a></dt>
<dd><p>Phase randomizes a signal by rotating frequency components by a random
angle. Negative frequencies are rotated in the opposite direction.
The nyquist frequency, if present, has it&#8217;s sign randomly flipped.</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.signal.phase_randomize_from_amplitudes">
<code class="descclassname">neurotools.signal.signal.</code><code class="descname">phase_randomize_from_amplitudes</code><span class="sig-paren">(</span><em>amplitudes</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/signal.html#phase_randomize_from_amplitudes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.signal.phase_randomize_from_amplitudes" title="Permalink to this definition">¶</a></dt>
<dd><p>treats input amplitudes as amplitudes of fourier components</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.signal.phase_rotate">
<code class="descclassname">neurotools.signal.signal.</code><code class="descname">phase_rotate</code><span class="sig-paren">(</span><em>s</em>, <em>f</em>, <em>Fs=1000.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/signal.html#phase_rotate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.signal.phase_rotate" title="Permalink to this definition">¶</a></dt>
<dd><p>Only the phase advancement portion of a resonator.
See resonantDrive</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.signal.pieces">
<code class="descclassname">neurotools.signal.signal.</code><code class="descname">pieces</code><span class="sig-paren">(</span><em>x</em>, <em>thr=4</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/signal.html#pieces"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.signal.pieces" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="neurotools.signal.signal.randband">
<code class="descclassname">neurotools.signal.signal.</code><code class="descname">randband</code><span class="sig-paren">(</span><em>N</em>, <em>fa=None</em>, <em>fb=None</em>, <em>Fs=1000</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/signal.html#randband"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.signal.randband" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns Gaussian random noise band-pass filtered between fa and fb.</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.signal.rewrap">
<code class="descclassname">neurotools.signal.signal.</code><code class="descname">rewrap</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/signal.html#rewrap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.signal.rewrap" title="Permalink to this definition">¶</a></dt>
<dd><p>Used to handle wraparound when getting phase derivatives.
See pdiff.</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.signal.set_edges">
<code class="descclassname">neurotools.signal.signal.</code><code class="descname">set_edges</code><span class="sig-paren">(</span><em>edges</em>, <em>N</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/signal.html#set_edges"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.signal.set_edges" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts list of start, stop times over time period N into a [0,1]
array which is 1 for any time between a [start,stop)
edge info outsize [0,N] results in undefined behavior</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.signal.sign_preserving_amplitude_demodulate">
<code class="descclassname">neurotools.signal.signal.</code><code class="descname">sign_preserving_amplitude_demodulate</code><span class="sig-paren">(</span><em>analytic_signal</em>, <em>doplot=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/signal.html#sign_preserving_amplitude_demodulate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.signal.sign_preserving_amplitude_demodulate" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts an amplitude-modulated component from an analytic signal,
Correctly flipping the sign of the signal when it crosses zero,
rather than returning a rectified result.</p>
<dl class="docutils">
<dt>Sign-changes are heuristically detected basd on the following:</dt>
<dd><ul class="first last simple">
<li>An abnormally large skip in phase between two time points,
larger than pi/2, that is also a local extremum in phase velocity</li>
<li>local minima in the amplitude at low-voltage with high curvature</li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.signal.triggeredaverage">
<code class="descclassname">neurotools.signal.signal.</code><code class="descname">triggeredaverage</code><span class="sig-paren">(</span><em>signal</em>, <em>times</em>, <em>window</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/signal.html#triggeredaverage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.signal.triggeredaverage" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="neurotools.signal.signal.unwrap">
<code class="descclassname">neurotools.signal.signal.</code><code class="descname">unwrap</code><span class="sig-paren">(</span><em>h</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/signal.html#unwrap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.signal.unwrap" title="Permalink to this definition">¶</a></dt>
<dd><p>Unwraps a sequences of phase measurements so that rather than
ranging from 0 to 2*pi, the values increase (or decrease) continuously.</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.signal.upsample">
<code class="descclassname">neurotools.signal.signal.</code><code class="descname">upsample</code><span class="sig-paren">(</span><em>x</em>, <em>factor=4</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/signal.html#upsample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.signal.upsample" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses fourier transform to upsample x by some factor.</p>
<p>Operations:
1. remove linear trend
2. mirror to get reflected boundary
3. take the fourier transform
4. add padding zeros to FFT to effectively upsample
5. taking inverse fourier transform
6. remove mirroring
7. restore linear tend</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>factor</strong> (<em>int</em>) &#8211; Integer upsampling factor. Default is 4.</li>
<li><strong>x</strong> (<em>array-like</em>) &#8211; X is cast to float64 before processing. Complex values are
not supported.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.signal.zeromean">
<code class="descclassname">neurotools.signal.signal.</code><code class="descname">zeromean</code><span class="sig-paren">(</span><em>x</em>, <em>axis=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/signal.html#zeromean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.signal.zeromean" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove the mean trend from data</p>
</dd></dl>

<dl class="function">
<dt id="neurotools.signal.signal.zscore">
<code class="descclassname">neurotools.signal.signal.</code><code class="descname">zscore</code><span class="sig-paren">(</span><em>x</em>, <em>axis=0</em>, <em>regularization=1e-30</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/signal/signal.html#zscore"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.signal.signal.zscore" title="Permalink to this definition">¶</a></dt>
<dd><p>Z-scores data, defaults to the first axis.
A regularization factor is added to the standard deviation to preven
numerical instability when the standard deviation is extremely small.
The default refularization is 1e-30.
x: NDarray
axis: axis to zscore; default 0</p>
</dd></dl>

</div>


          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, M Rule.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'2',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>