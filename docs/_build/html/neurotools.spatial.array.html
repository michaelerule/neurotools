

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>neurotools.spatial.array module &mdash; Neurotools 2 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="neurotools.spatial.dct module" href="neurotools.spatial.dct.html" />
    <link rel="prev" title="neurotools.spatial package" href="neurotools.spatial.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Neurotools
          

          
          </a>

          
            
            
              <div class="version">
                2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">neurotools</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="neurotools.html">neurotools package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="neurotools.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="neurotools.encoding.html">neurotools.encoding package</a></li>
<li class="toctree-l4"><a class="reference internal" href="neurotools.gpu.html">neurotools.gpu package</a></li>
<li class="toctree-l4"><a class="reference internal" href="neurotools.graphics.html">neurotools.graphics package</a></li>
<li class="toctree-l4"><a class="reference internal" href="neurotools.jobs.html">neurotools.jobs package</a></li>
<li class="toctree-l4"><a class="reference internal" href="neurotools.linalg.html">neurotools.linalg package</a></li>
<li class="toctree-l4"><a class="reference internal" href="neurotools.models.html">neurotools.models package</a></li>
<li class="toctree-l4"><a class="reference internal" href="neurotools.signal.html">neurotools.signal package</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="neurotools.spatial.html">neurotools.spatial package</a><ul class="current">
<li class="toctree-l5 current"><a class="reference internal" href="neurotools.spatial.html#submodules">Submodules</a></li>
<li class="toctree-l5"><a class="reference internal" href="neurotools.spatial.html#module-neurotools.spatial">Module contents</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="neurotools.spikes.html">neurotools.spikes package</a></li>
<li class="toctree-l4"><a class="reference internal" href="neurotools.stats.html">neurotools.stats package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="neurotools.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="neurotools.html#module-neurotools">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Neurotools</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="modules.html">neurotools</a> &raquo;</li>
        
          <li><a href="neurotools.html">neurotools package</a> &raquo;</li>
        
          <li><a href="neurotools.spatial.html">neurotools.spatial package</a> &raquo;</li>
        
      <li>neurotools.spatial.array module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/neurotools.spatial.array.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-neurotools.spatial.array">
<span id="neurotools-spatial-array-module"></span><h1>neurotools.spatial.array module<a class="headerlink" href="#module-neurotools.spatial.array" title="Permalink to this headline">¶</a></h1>
<p>Statistical routines to extract spatial summary statistics from 2D
arrays of complex-valued (phase,amplitude) signals.</p>
<dl class="function">
<dt id="neurotools.spatial.array.array_average_amplitude">
<code class="descclassname">neurotools.spatial.array.</code><code class="descname">array_average_amplitude</code><span class="sig-paren">(</span><em>frames</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/spatial/array.html#array_average_amplitude"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.spatial.array.array_average_amplitude" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the average signal amplitude envelope over multi-electrode
array data.
Assumes first two dimensions are (x,y) spatial dimensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>frames</strong> (<em>np.array</em>) – ND numpy array of complex-valued signals with phase and amplitude.
Must be at least 2D. The first 2 dimensions are spatial
dimensions (x,y).</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The average absolute magnitude over the first two axes</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="neurotools.spatial.array.array_kuramoto">
<code class="descclassname">neurotools.spatial.array.</code><code class="descname">array_kuramoto</code><span class="sig-paren">(</span><em>frames</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/spatial/array.html#array_kuramoto"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.spatial.array.array_kuramoto" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the Kuramoto order parameter
over 2D multi-electrode array given complex-valued analytic signals.
Assumes first two dimensions are (x,y) spatial dimensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>frames</strong> (<em>np.array</em>) – ND numpy array of complex-valued signals with phase and amplitude.
Must be at least 2D. The first 2 dimensions are spatial
dimensions (x,y).</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The Kuramotor order parameter over the first two axes</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="neurotools.spatial.array.array_synchrony">
<code class="descclassname">neurotools.spatial.array.</code><code class="descname">array_synchrony</code><span class="sig-paren">(</span><em>frames</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/spatial/array.html#array_synchrony"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.spatial.array.array_synchrony" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the
average phase syncrony
over 2D multi-electrode array given complex-valued analytic signals.
Assumes first two dimensions are (x,y) spatial dimensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>frames</strong> (<em>np.array</em>) – ND numpy array of complex-valued signals with phase and amplitude.
Must be at least 2D. The first 2 dimensions are spatial
dimensions (x,y).</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The average phase syncrony over the first two axes</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="neurotools.spatial.array.array_kuramoto_standard_deviation">
<code class="descclassname">neurotools.spatial.array.</code><code class="descname">array_kuramoto_standard_deviation</code><span class="sig-paren">(</span><em>frames</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/spatial/array.html#array_kuramoto_standard_deviation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.spatial.array.array_kuramoto_standard_deviation" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the
Kuramoto order parameter, transformed to units of radians
over 2D multi-electrode array given complex-valued analytic signals.
Assumes first two dimensions are (x,y) spatial dimensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>frames</strong> (<em>np.array</em>) – ND numpy array of complex-valued signals with phase and amplitude.
Must be at least 2D. The first 2 dimensions are spatial
dimensions (x,y).</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The Kuramotor order parameter transformed to units of radians</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="neurotools.spatial.array.array_synchrony_standard_deviation">
<code class="descclassname">neurotools.spatial.array.</code><code class="descname">array_synchrony_standard_deviation</code><span class="sig-paren">(</span><em>frames</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/spatial/array.html#array_synchrony_standard_deviation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.spatial.array.array_synchrony_standard_deviation" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the
average phase syncrony, transformed to units of radians
over 2D multi-electrode array given complex-valued analytic signals.
Assumes first two dimensions are (x,y) spatial dimensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>frames</strong> (<em>np.array</em>) – ND numpy array of complex-valued signals with phase and amplitude.
Must be at least 2D. The first 2 dimensions are spatial
dimensions (x,y).</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The average phase syncrony over the first two axes
transformed to units of radians</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="neurotools.spatial.array.array_phase_gradient">
<code class="descclassname">neurotools.spatial.array.</code><code class="descname">array_phase_gradient</code><span class="sig-paren">(</span><em>frame</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/spatial/array.html#array_phase_gradient"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.spatial.array.array_phase_gradient" title="Permalink to this definition">¶</a></dt>
<dd><p>Assumes complex input (analytic signals)
Assumes first 2 dimensions are array dimensions
Remaining dimensions can be arbitrary
first dimention is Y second is X ( row major ordering )</p>
<p>The differentiation kernel is [1 -1; 1 -1]/2, exept at the boundaries.</p>
<p>The returned phase gradients are two-dimensional, and encoded as
a complex number (in analogy to the analytic signal). The gradient
along the first dimension (x) is encoded in the real part, and the
gradient along the second dimension (y) is encoded in the imaginary
part.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>frame</strong> (<em>np.array</em>) – ND numpy array of complex-valued signals with phase and amplitude.
Must be at least 2D. The first 2 dimensions are spatial
dimensions (x,y).</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Arra phase gradients encoded as complex numbers</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="neurotools.spatial.array.array_count_centers">
<code class="descclassname">neurotools.spatial.array.</code><code class="descname">array_count_centers</code><span class="sig-paren">(</span><em>data</em>, <em>upsample=3</em>, <em>cut=True</em>, <em>cutoff=0.4</em>, <em>electrode_spacing=0.4</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/spatial/array.html#array_count_centers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.spatial.array.array_count_centers" title="Permalink to this definition">¶</a></dt>
<dd><p>Counting centers – looks for channels around which phase skips +-np.pi</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> (<em>np.array</em>) – Data should be sent in a 3-dimensional np.array of complex analytic
signals, where the first two dimensions are the (x,y) spatial
dimensions of the multi-electrode array.</p>
</dd>
<dt class="field-even">Other Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>upsample</strong> (<em>int, default is 3</em>) – Upsampling factor for interpolating between electrodes</p></li>
<li><p><strong>cut</strong> (<em>bool, default is True</em>) – Whether to apply a spatial frequency cutoff.</p></li>
<li><p><strong>cutoff</strong> (<em>float, default is 0.4</em>) – Spatial scale cutoff for analysis, in mm</p></li>
<li><p><strong>electrode_spacing</strong> (<em>float, default 0.4</em>) – Spacing between electrodes in array in mm. Default is 0.4mm for
the Utah arrays</p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>nclockwise</strong> (<em>np.array</em>) – number of clockwise centers found at each time point</p></li>
<li><p><strong>nanticlockwise</strong> (<em>np.array</em>) – number of anticlockwise centers found at each time point</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="neurotools.spatial.array.array_count_critical">
<code class="descclassname">neurotools.spatial.array.</code><code class="descname">array_count_critical</code><span class="sig-paren">(</span><em>data</em>, <em>upsample=3</em>, <em>cut=True</em>, <em>cutoff=0.4</em>, <em>electrode_spacing=0.4</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/spatial/array.html#array_count_critical"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.spatial.array.array_count_critical" title="Permalink to this definition">¶</a></dt>
<dd><p>Count critical points in the phase gradient map</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> (<em>np.array</em>) – Data should be sent in a 3-dimensional np.array of complex analytic
signals, where the first two dimensions are the (x,y) spatial
dimensions of the multi-electrode array.</p>
</dd>
<dt class="field-even">Other Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>upsample</strong> (<em>int, default is 3</em>) – Upsampling factor for interpolating between electrodes</p></li>
<li><p><strong>cut</strong> (<em>bool, default is True</em>) – Whether to apply a spatial frequency cutoff.</p></li>
<li><p><strong>cutoff</strong> (<em>float, default is 0.4</em>) – Spatial scale cutoff for analysis.</p></li>
<li><p><strong>electrode_spacing</strong> (<em>float, default 0.4</em>) – Spacing between electrodes in array in mm. Default is 0.4mm for
the Utah arrays</p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>nclockwise</strong> (<em>np.array</em>) – number of clockwise centers found at each time point</p></li>
<li><p><strong>nanticlockwise</strong> (<em>np.array</em>) – number of anticlockwise centers found at each time point</p></li>
<li><p><strong>nsaddles</strong> (<em>np.array</em>) – number of saddle points</p></li>
<li><p><strong>nmaxima</strong> (<em>np.array</em>) – number of local maxima</p></li>
<li><p><strong>nminima</strong> (<em>np.array</em>) – number of local minima</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="neurotools.spatial.array.array_phasegradient_local">
<code class="descclassname">neurotools.spatial.array.</code><code class="descname">array_phasegradient_local</code><span class="sig-paren">(</span><em>frame</em>, <em>electrode_spacing=0.4</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/spatial/array.html#array_phasegradient_local"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.spatial.array.array_phasegradient_local" title="Permalink to this definition">¶</a></dt>
<dd><p>The average local gradient magnitude provides an upper bound on
spatial frequency ( lower bound on wavelength ).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>frame</strong> (<em>np.array</em>) – ND numpy array of complex-valued signals with phase and amplitude.
Must be at least 2D. The first 2 dimensions are spatial
dimensions (x,y).</p></li>
<li><p><strong>electrode_spacing</strong> (<em>float</em><em>, </em><em>default 0.4</em>) – Spacing between electrodes in array in mm. Default is 0.4mm for
the Utah arrays</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Average phase gradient magniture across array, in cycles/mm</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="neurotools.spatial.array.array_phasegradient_planar">
<code class="descclassname">neurotools.spatial.array.</code><code class="descname">array_phasegradient_planar</code><span class="sig-paren">(</span><em>frame</em>, <em>electrode_spacing=0.4</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/spatial/array.html#array_phasegradient_planar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.spatial.array.array_phasegradient_planar" title="Permalink to this definition">¶</a></dt>
<dd><p>The magnitude of the average gradient provides an accurate estimate
of plane-wave wavelength even in the presence of noise.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>frame</strong> (<em>np.array</em>) – ND numpy array of complex-valued signals with phase and amplitude.
Must be at least 2D. The first 2 dimensions are spatial
dimensions (x,y).</p></li>
<li><p><strong>electrode_spacing</strong> (<em>float</em><em>, </em><em>default 0.4</em>) – Spacing between electrodes in array in mm. Default is 0.4mm for
the Utah arrays</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Magnitude of average phase gradient across array, in cycles/mm</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="neurotools.spatial.array.array_phasegradient_magnitude_sigma">
<code class="descclassname">neurotools.spatial.array.</code><code class="descname">array_phasegradient_magnitude_sigma</code><span class="sig-paren">(</span><em>frame</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/spatial/array.html#array_phasegradient_magnitude_sigma"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.spatial.array.array_phasegradient_magnitude_sigma" title="Permalink to this definition">¶</a></dt>
<dd><p>Assess standard deviation of phase gradient magnitudes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>frame</strong> (<em>np.array</em>) – ND numpy array of complex-valued signals with phase and amplitude.
Must be at least 2D. The first 2 dimensions are spatial
dimensions (x,y).</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The standard-deviation of the absolute magnitude of the
local phase gradient across an array, in cycles/mm</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="neurotools.spatial.array.array_phasegradient_magnitude_cv">
<code class="descclassname">neurotools.spatial.array.</code><code class="descname">array_phasegradient_magnitude_cv</code><span class="sig-paren">(</span><em>frame</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/spatial/array.html#array_phasegradient_magnitude_cv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.spatial.array.array_phasegradient_magnitude_cv" title="Permalink to this definition">¶</a></dt>
<dd><p>Coefficient of variation of the magnitudes of the phase gradients</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>frame</strong> (<em>np.array</em>) – ND numpy array of complex-valued signals with phase and amplitude.
Must be at least 2D. The first 2 dimensions are spatial
dimensions (x,y).</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Coefficient of variation of the magnitudes of the phase gradients,
in cycles/mm</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="neurotools.spatial.array.array_phasegradient_pgd_threshold">
<code class="descclassname">neurotools.spatial.array.</code><code class="descname">array_phasegradient_pgd_threshold</code><span class="sig-paren">(</span><em>frame</em>, <em>thresh=0.5</em>, <em>electrode_spacing=0.4</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/spatial/array.html#array_phasegradient_pgd_threshold"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.spatial.array.array_phasegradient_pgd_threshold" title="Permalink to this definition">¶</a></dt>
<dd><p>The magnitude of the average gradient provides an accurate estimate
of wavelength even in the presence of noise.</p>
<p>Waves with
phase-gradient directionlity below threshold will be removed to
reduce the contribution of noise to wavelength estimates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>frame</strong> (<em>np.array</em>) – ND numpy array of complex-valued signals with phase and amplitude.
Must be at least 2D. The first 2 dimensions are spatial
dimensions (x,y).</p>
</dd>
<dt class="field-even">Other Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>thresh</strong> (<em>float, default 0.5</em>) – The minimum phase-gradient directionality measure. Waves with
phase-gradient directionlity below threshold will be removed to
further reduce the contribution of noise to wavelength estimates.</p></li>
<li><p><strong>electrode_spacing</strong> (<em>float, default 0.4</em>) – Spacing between electrodes in array in mm. Default is 0.4mm for
the Utah arrays</p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Magnitude of average phase gradient across array, in cycles/mm
for every time-point</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="neurotools.spatial.array.array_wavelength_pgd_threshold">
<code class="descclassname">neurotools.spatial.array.</code><code class="descname">array_wavelength_pgd_threshold</code><span class="sig-paren">(</span><em>frame</em>, <em>thresh=0.5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/spatial/array.html#array_wavelength_pgd_threshold"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.spatial.array.array_wavelength_pgd_threshold" title="Permalink to this definition">¶</a></dt>
<dd><p>The magnitude of the average gradient provides a very accurate estimate
of wavelength even in the presence of noise. We can further restrict
analysis to wavelength with a phase-gradient directionality above
a certain threshold.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>frame</strong> (<em>np.array</em>) – ND numpy array of complex-valued signals with phase and amplitude.
Must be at least 2D. The first 2 dimensions are spatial
dimensions (x,y).</p>
</dd>
<dt class="field-even">Other Parameters</dt>
<dd class="field-even"><p><strong>thresh</strong> (<em>float, default 0.5</em>) – The minimum phase-gradient directionality measure. Waves with
phase-gradient directionlity below threshold will be removed to
further reduce the contribution of noise to wavelength estimates.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>wavelength in mm/cycle for wave events above the PGD threshold</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="neurotools.spatial.array.array_wavelength_local_pgd_threshold">
<code class="descclassname">neurotools.spatial.array.</code><code class="descname">array_wavelength_local_pgd_threshold</code><span class="sig-paren">(</span><em>frame</em>, <em>thresh=0.5</em>, <em>electrode_spacing=0.4</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/spatial/array.html#array_wavelength_local_pgd_threshold"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.spatial.array.array_wavelength_local_pgd_threshold" title="Permalink to this definition">¶</a></dt>
<dd><p>The average phase gradient magnitude can tolerate non-planar waves,
but is sensitive to noise. It may be appropriate to combine
this method with spatial smoothing to denoise the data, if it is safe
to assume a minimum spatial scale for the underlying wave dynamics.</p>
<p>To be conservative, this routine excludes waves with phase-gradient
directionality below the provided threshold.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>frame</strong> (<em>np.array</em>) – ND numpy array of complex-valued signals with phase and amplitude.
Must be at least 2D. The first 2 dimensions are spatial
dimensions (x,y).</p>
</dd>
<dt class="field-even">Other Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>thresh</strong> (<em>float, default 0.5</em>) – The minimum phase-gradient directionality measure. Waves with
phase-gradient directionlity below threshold will be removed to
further reduce the contribution of noise to wavelength estimates.</p></li>
<li><p><strong>electrode_spacing</strong> (<em>float, default 0.4</em>) – Spacing between electrodes in array in mm. Default is 0.4mm for
the Utah arrays</p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>wavelength in mm/cycle for wave events above the PGD threshold</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="neurotools.spatial.array.array_speed_pgd_threshold">
<code class="descclassname">neurotools.spatial.array.</code><code class="descname">array_speed_pgd_threshold</code><span class="sig-paren">(</span><em>frame</em>, <em>thresh=0.5</em>, <em>FS=1000.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/spatial/array.html#array_speed_pgd_threshold"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.spatial.array.array_speed_pgd_threshold" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate an estimated wave speed for waves above the given PGD
threshold.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>frame</strong> (<em>np.array</em>) – ND numpy array of complex-valued signals with phase and amplitude.
Must be at least 2D. The first 2 dimensions are spatial
dimensions (x,y).</p>
</dd>
<dt class="field-even">Other Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>thresh</strong> (<em>float, default 0.5</em>) – The minimum phase-gradient directionality measure. Waves with
phase-gradient directionlity below threshold will be removed to
further reduce the contribution of noise to wavelength estimates.</p></li>
<li><p><strong>electrode_spacing</strong> (<em>float, default 0.4</em>) – Spacing between electrodes in array in mm. Default is 0.4mm for
the Utah arrays</p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>speed for plane waves in mm/s</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="neurotools.spatial.array.array_speed_local">
<code class="descclassname">neurotools.spatial.array.</code><code class="descname">array_speed_local</code><span class="sig-paren">(</span><em>frame</em>, <em>FS=1000.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/spatial/array.html#array_speed_local"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.spatial.array.array_speed_local" title="Permalink to this definition">¶</a></dt>
<dd><p>Accuracy can be improved by restricting analysis to waves with high
phase-gradient directionality, where the coherent propagation direction
between channels allows for more reliable gradient estimates. High
signal-to-noise ratio can also mitigate the impact of noise.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>frame</strong> (<em>np.array</em>) – ND numpy array of complex-valued signals with phase and amplitude.
Must be at least 2D. The first 2 dimensions are spatial
dimensions (x,y).</p>
</dd>
<dt class="field-even">Other Parameters</dt>
<dd class="field-even"><p><strong>FS</strong> (<em>float, default 1000</em>) – Sampling rate</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>speed for plane waves in mm/s</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="neurotools.spatial.array.array_wavelength_local">
<code class="descclassname">neurotools.spatial.array.</code><code class="descname">array_wavelength_local</code><span class="sig-paren">(</span><em>frame</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/spatial/array.html#array_wavelength_local"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.spatial.array.array_wavelength_local" title="Permalink to this definition">¶</a></dt>
<dd><p>phase gradients are in units of radians per electrode</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>frame</strong> (<em>np.array</em>) – ND numpy array of complex-valued signals with phase and amplitude.
Must be at least 2D. The first 2 dimensions are spatial
dimensions (x,y).</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>wavelengths in mm/cycle</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="neurotools.spatial.array.array_wavelength_planar">
<code class="descclassname">neurotools.spatial.array.</code><code class="descname">array_wavelength_planar</code><span class="sig-paren">(</span><em>frame</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/spatial/array.html#array_wavelength_planar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.spatial.array.array_wavelength_planar" title="Permalink to this definition">¶</a></dt>
<dd><p>phase gradients are in units of radians per electrode</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>frame</strong> (<em>np.array</em>) – ND numpy array of complex-valued signals with phase and amplitude.
Must be at least 2D. The first 2 dimensions are spatial
dimensions (x,y).</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>wavelengths in mm/cycle</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="neurotools.spatial.array.array_synchrony_pgd">
<code class="descclassname">neurotools.spatial.array.</code><code class="descname">array_synchrony_pgd</code><span class="sig-paren">(</span><em>frame</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/spatial/array.html#array_synchrony_pgd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.spatial.array.array_synchrony_pgd" title="Permalink to this definition">¶</a></dt>
<dd><p>The phase gradient directionality measure from Rubinto et al 2009 is
abs(mean(pg))/mean(abs(pg))</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>frame</strong> (<em>np.array</em>) – ND numpy array of complex-valued signals with phase and amplitude.
Must be at least 2D. The first 2 dimensions are spatial
dimensions (x,y).</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Phase gradient directionlity measure for each timepoint</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="neurotools.spatial.array.array_synchrony_pgd_standard_deviation">
<code class="descclassname">neurotools.spatial.array.</code><code class="descname">array_synchrony_pgd_standard_deviation</code><span class="sig-paren">(</span><em>frame</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/spatial/array.html#array_synchrony_pgd_standard_deviation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.spatial.array.array_synchrony_pgd_standard_deviation" title="Permalink to this definition">¶</a></dt>
<dd><p>The phase gradient directionality measure from Rubinto et al 2009 is
abs(mean(pg))/mean(abs(pg)).</p>
<p>This routine applies a nonlinear transformation so that PGD has units
of radians, for easier interpretation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>frame</strong> (<em>np.array</em>) – ND numpy array of complex-valued signals with phase and amplitude.
Must be at least 2D. The first 2 dimensions are spatial
dimensions (x,y).</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Phase gradient directionality, transformed to
have units of radians in analogy to the standard deviation of a
circularly wrapped normal distribution.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="neurotools.spatial.array.array_kuramoto_pgd">
<code class="descclassname">neurotools.spatial.array.</code><code class="descname">array_kuramoto_pgd</code><span class="sig-paren">(</span><em>frame</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/spatial/array.html#array_kuramoto_pgd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.spatial.array.array_kuramoto_pgd" title="Permalink to this definition">¶</a></dt>
<dd><p>A directionality index based on the Kuramoto order parameter.
Phase gradient magnitude is discarded.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>frame</strong> (<em>np.array</em>) – ND numpy array of complex-valued signals with phase and amplitude.
Must be at least 2D. The first 2 dimensions are spatial
dimensions (x,y).</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Kuramoto gradient directionlity measure for each timepoint</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="neurotools.spatial.array.array_kuramoto_pgd_standard_deviation">
<code class="descclassname">neurotools.spatial.array.</code><code class="descname">array_kuramoto_pgd_standard_deviation</code><span class="sig-paren">(</span><em>frame</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/spatial/array.html#array_kuramoto_pgd_standard_deviation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.spatial.array.array_kuramoto_pgd_standard_deviation" title="Permalink to this definition">¶</a></dt>
<dd><p>A directionality index based on the Kuramoto order parameter.
Phase gradient magnitude is discarded.</p>
<p>The resulting order parameter is nonlinearly transformed to have
units of radians in analogy to the standard deviation of a
circularly wrapped normal distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>frame</strong> (<em>np.array</em>) – ND numpy array of complex-valued signals with phase and amplitude.
Must be at least 2D. The first 2 dimensions are spatial
dimensions (x,y).</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Kuramoto gradient directionlity measure for each timepoint, transformed
to units of radians in analogy to the standard deviation of a
circularly wrapped normal distribution.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="neurotools.spatial.array.trim_array">
<code class="descclassname">neurotools.spatial.array.</code><code class="descname">trim_array</code><span class="sig-paren">(</span><em>arrayMap</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/spatial/array.html#trim_array"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.spatial.array.trim_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes any rows or columns from the array map
that are empty ( have no channels )</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>arrayMap</strong> (<em>np.array</em>) – Array map of channel locations. -1 marks missing channels</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Trimmed map: any rows or columns that are entirely -1 are removed.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="neurotools.spatial.array.trim_array_as_if">
<code class="descclassname">neurotools.spatial.array.</code><code class="descname">trim_array_as_if</code><span class="sig-paren">(</span><em>arrayMap</em>, <em>data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/spatial/array.html#trim_array_as_if"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.spatial.array.trim_array_as_if" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes any rows or columns from data if those rows or columns are
empty ( have no channels ) in the arrayMap.</p>
<p>This routine is useful for cropping larger arrays down to smaller
sizes, to verify that the statistical estimates do not depend on
the array size.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arrayMap</strong> (<em>np.array</em>) – Array map of channel locations. -1 marks missing channels</p></li>
<li><p><strong>data</strong> (<em>np.array</em>) – A 3-dimensional np.array
where the first two dimensions are the (x,y) spatial
dimensions of the multi-electrode array.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the data array input, with rows or columns removed where arrayMap
is missing channels.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="neurotools.spatial.array.pack_array_data">
<code class="descclassname">neurotools.spatial.array.</code><code class="descname">pack_array_data</code><span class="sig-paren">(</span><em>data</em>, <em>arrayMap</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neurotools/spatial/array.html#pack_array_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neurotools.spatial.array.pack_array_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Accepts a collection of signals from array channels, as well as
an array map containing indecies (1-indexed for backwards compatibility
with matlab) into that list of channel data.</p>
<p>This will interpolate missing channels as an average of nearest
neighbors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>np.array</em>) – NChannel x Ntimes</p></li>
<li><p><strong>arrayMap</strong> (<em>np.array</em>) – array map, 1-indexed, 0 for missing electrodes</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>LxKxNtimes 3D array of the interpolated channel data</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="neurotools.spatial.dct.html" class="btn btn-neutral float-right" title="neurotools.spatial.dct module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="neurotools.spatial.html" class="btn btn-neutral float-left" title="neurotools.spatial package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2017, M Rule.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>